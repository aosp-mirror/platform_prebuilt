<html lang="en">
<head>
<title>The GNU configure and build system</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="The GNU configure and build system">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="top" href="#Top">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
This file documents the GNU configure and build system.

   <p>Copyright (C) 1998 Cygnus Solutions.

   <p>Permission is granted to make and distribute verbatim copies of
this manual provided the copyright notice and this permission notice
are preserved on all copies.

   <p>Permission is granted to copy and distribute modified versions of this
manual under the conditions for verbatim copying, provided that the entire
resulting derived work is distributed under the terms of a permission
notice identical to this one.

   <p>Permission is granted to copy and distribute translations of this manual
into another language, under the above conditions for modified versions,
except that this permission notice may be stated in a translation approved
by the Foundation.

<div class="node">
<a name="Top"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Introduction">Introduction</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#dir">(dir)</a>

</div>

<h2 class="unnumbered">GNU configure and build system</h2>

<p>The GNU configure and build system.

<ul class="menu">
<li><a accesskey="1" href="#Introduction">Introduction</a>: 		Introduction. 
<li><a accesskey="2" href="#Getting-Started">Getting Started</a>: 		Getting Started. 
<li><a accesskey="3" href="#Files">Files</a>: 			Files. 
<li><a accesskey="4" href="#Configuration-Names">Configuration Names</a>: 		Configuration Names. 
<li><a accesskey="5" href="#Cross-Compilation-Tools">Cross Compilation Tools</a>: 	Cross Compilation Tools. 
<li><a accesskey="6" href="#Canadian-Cross">Canadian Cross</a>: 		Canadian Cross. 
<li><a accesskey="7" href="#Cygnus-Configure">Cygnus Configure</a>: 		Cygnus Configure. 
<li><a accesskey="8" href="#Multilibs">Multilibs</a>: 			Multilibs. 
<li><a accesskey="9" href="#FAQ">FAQ</a>: 				Frequently Asked Questions. 
<li><a href="#Index">Index</a>: 			Index. 
</ul>

<div class="node">
<a name="Introduction"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Getting-Started">Getting Started</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Top">Top</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">1 Introduction</h2>

<p>This document describes the GNU configure and build systems.  It
describes how autoconf, automake, libtool, and make fit together.  It
also includes a discussion of the older Cygnus configure system.

   <p>This document does not describe in detail how to use each of the tools;
see the respective manuals for that.  Instead, it describes which files
the developer must write, which files are machine generated and how they
are generated, and where certain common problems should be addressed.

   <p>This document draws on several sources, including
<a href="http://www.delorie.com/gnu/docs/autoconf/autoconf_toc.html">the autoconf manual</a> by David MacKenzie,
<a href="http://www.delorie.com/gnu/docs/automake/automake_toc.html">the automake manual</a> by David MacKenzie and Tom Tromey,
<a href="http://www.delorie.com/gnu/docs/libtool/libtool_toc.html">the libtool manual</a> by Gordon Matzigkeit, and the Cygnus configure manual by
K. Richard Pixley.

<ul class="menu">
<li><a accesskey="1" href="#Goals">Goals</a>: 			Goals. 
<li><a accesskey="2" href="#Tools">Tools</a>: 			The tools. 
<li><a accesskey="3" href="#History">History</a>: 			History. 
<li><a accesskey="4" href="#Building">Building</a>: 			Building. 
</ul>

<div class="node">
<a name="Goals"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Tools">Tools</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>

</div>

<h3 class="section">1.1 Goals</h3>

<p><a name="index-goals-1"></a>
The GNU configure and build system has two main goals.

   <p>The first is to simplify the development of portable programs.  The
system permits the developer to concentrate on writing the program,
simplifying many details of portability across Unix and even Windows
systems, and permitting the developer to describe how to build the
program using simple rules rather than complex Makefiles.

   <p>The second is to simplify the building of programs distributed as source
code.  All programs are built using a simple, standardized, two step
process.  The program builder need not install any special tools in
order to build the program.

<div class="node">
<a name="Tools"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#History">History</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Goals">Goals</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>

</div>

<h3 class="section">1.2 Tools</h3>

<p>The GNU configure and build system is comprised of several different
tools.  Program developers must build and install all of these tools.

   <p>People who just want to build programs from distributed sources normally
do not need any special tools beyond a Unix shell, a make program, and a
C compiler.

     <dl>
<dt>autoconf<dd>provides a general portability framework, based on testing the features
of the host system at build time. 
<br><dt>automake<dd>a system for describing how to build a program, permitting the developer
to write a simplified <samp><span class="file">Makefile</span></samp>. 
<br><dt>libtool<dd>a standardized approach to building shared libraries. 
<br><dt>gettext<dd>provides a framework for translation of text messages into other
languages; not really discussed in this document. 
<br><dt>m4<dd>autoconf requires the GNU version of m4; the standard Unix m4 does not
suffice. 
<br><dt>perl<dd>automake requires perl. 
</dl>

<div class="node">
<a name="History"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Building">Building</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Tools">Tools</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>

</div>

<h3 class="section">1.3 History</h3>

<p><a name="index-history-2"></a>
This is a very brief and probably inaccurate history.

   <p>As the number of Unix variants increased during the 1980s, it became
harder to write programs which could run on all variants.  While it was
often possible to use <code>#ifdef</code> to identify particular systems,
developers frequently did not have access to every system, and the
characteristics of some systems changed from version to version.

   <p>By 1992, at least three different approaches had been developed:
     <ul>
<li>The Metaconfig program, by Larry Wall, Harlan Stenn, and Raphael
Manfredi. 
<li>The Cygnus configure script, by K. Richard Pixley, and the gcc configure
script, by Richard Stallman.  These use essentially the same approach,
and the developers communicated regularly. 
<li>The autoconf program, by David MacKenzie. 
</ul>

   <p>The Metaconfig program is still used for Perl and a few other programs. 
It is part of the Dist package.  I do not know if it is being developed.

   <p>In 1994, David MacKenzie and others modified autoconf to incorporate all
the features of Cygnus configure.  Since then, there has been a slow but
steady conversion of GNU programs from Cygnus configure to autoconf. gcc
has been converted, eliminating the gcc configure script.

   <p>GNU autoconf was regularly maintained until late 1996.  As of this
writing in June, 1998, it has no public maintainer.

   <p>Most programs are built using the make program, which requires the
developer to write Makefiles describing how to build the programs. 
Since most programs are built in pretty much the same way, this led to a
lot of duplication.

   <p>The X Window system is built using the imake tool, which uses a database
of rules to eliminate the duplication.  However, building a tool which
was developed using imake requires that the builder have imake
installed, violating one of the goals of the GNU system.

   <p>The new BSD make provides a standard library of Makefile fragments,
which permits developers to write very simple Makefiles.  However, this
requires that the builder install the new BSD make program.

   <p>In 1994, David MacKenzie wrote the first version of automake, which
permitted writing a simple build description which was converted into a
Makefile which could be used by the standard make program.  In 1995, Tom
Tromey completely rewrote automake in Perl, and he continues to enhance
it.

   <p>Various free packages built libraries, and by around 1995 several
included support to build shared libraries on various platforms. 
However, there was no consistent approach.  In early 1996, Gordon
Matzigkeit began working on libtool, which provided a standardized
approach to building shared libraries.  This was integrated into
automake from the start.

   <p>The development of automake and libtool was driven by the GNITS project,
a group of GNU maintainers who designed standardized tools to help meet
the GNU coding standards.

<div class="node">
<a name="Building"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#History">History</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Introduction">Introduction</a>

</div>

<h3 class="section">1.4 Building</h3>

<p>Most readers of this document should already know how to build a tool by
running &lsquo;<samp><span class="samp">configure</span></samp>&rsquo; and &lsquo;<samp><span class="samp">make</span></samp>&rsquo;.  This section may serve as a
quick introduction or reminder.

   <p>Building a tool is normally as simple as running &lsquo;<samp><span class="samp">configure</span></samp>&rsquo;
followed by &lsquo;<samp><span class="samp">make</span></samp>&rsquo;.  You should normally run &lsquo;<samp><span class="samp">configure</span></samp>&rsquo; from
an empty directory, using some path to refer to the &lsquo;<samp><span class="samp">configure</span></samp>&rsquo;
script in the source directory.  The directory in which you run
&lsquo;<samp><span class="samp">configure</span></samp>&rsquo; is called the <dfn>object directory</dfn>.

   <p>In order to use a object directory which is different from the source
directory, you must be using the GNU version of &lsquo;<samp><span class="samp">make</span></samp>&rsquo;, which has
the required &lsquo;<samp><span class="samp">VPATH</span></samp>&rsquo; support.  Despite this restriction, using a
different object directory is highly recommended:
     <ul>
<li>It keeps the files generated during the build from cluttering up your
sources. 
<li>It permits you to remove the built files by simply removing the entire
build directory. 
<li>It permits you to build from the same sources with several sets of
configure options simultaneously. 
</ul>

   <p>If you don't have GNU &lsquo;<samp><span class="samp">make</span></samp>&rsquo;, you will have to run &lsquo;<samp><span class="samp">configure</span></samp>&rsquo;
in the source directory.  All GNU packages should support this; in
particular, GNU packages should not assume the presence of GNU
&lsquo;<samp><span class="samp">make</span></samp>&rsquo;.

   <p>After running &lsquo;<samp><span class="samp">configure</span></samp>&rsquo;, you can build the tools by running
&lsquo;<samp><span class="samp">make</span></samp>&rsquo;.

   <p>To install the tools, run &lsquo;<samp><span class="samp">make install</span></samp>&rsquo;.  Installing the tools
will copy the programs and any required support files to the
<dfn>installation directory</dfn>.  The location of the installation
directory is controlled by &lsquo;<samp><span class="samp">configure</span></samp>&rsquo; options, as described below.

   <p>In the Cygnus tree at present, the info files are built and installed as
a separate step.  To build them, run &lsquo;<samp><span class="samp">make info</span></samp>&rsquo;.  To install them,
run &lsquo;<samp><span class="samp">make install-info</span></samp>&rsquo;. The equivalent html files are also built
and installed in a separate step. To build the html files, run
&lsquo;<samp><span class="samp">make html</span></samp>&rsquo;. To install the html files run &lsquo;<samp><span class="samp">make install-html</span></samp>&rsquo;.

   <p>All &lsquo;<samp><span class="samp">configure</span></samp>&rsquo; scripts support a wide variety of options.  The
most interesting ones are &lsquo;<samp><span class="samp">--with</span></samp>&rsquo; and &lsquo;<samp><span class="samp">--enable</span></samp>&rsquo; options
which are generally specific to particular tools.  You can usually use
the &lsquo;<samp><span class="samp">--help</span></samp>&rsquo; option to get a list of interesting options for a
particular configure script.

   <p>The only generic options you are likely to use are the &lsquo;<samp><span class="samp">--prefix</span></samp>&rsquo;
and &lsquo;<samp><span class="samp">--exec-prefix</span></samp>&rsquo; options.  These options are used to specify the
installation directory.

   <p>The directory named by the &lsquo;<samp><span class="samp">--prefix</span></samp>&rsquo; option will hold machine
independent files such as info files.

   <p>The directory named by the &lsquo;<samp><span class="samp">--exec-prefix</span></samp>&rsquo; option, which is
normally a subdirectory of the &lsquo;<samp><span class="samp">--prefix</span></samp>&rsquo; directory, will hold
machine dependent files such as executables.

   <p>The default for &lsquo;<samp><span class="samp">--prefix</span></samp>&rsquo; is <samp><span class="file">/usr/local</span></samp>.  The default for
&lsquo;<samp><span class="samp">--exec-prefix</span></samp>&rsquo; is the value used for &lsquo;<samp><span class="samp">--prefix</span></samp>&rsquo;.

   <p>The convention used in Cygnus releases is to use a &lsquo;<samp><span class="samp">--prefix</span></samp>&rsquo;
option of <samp><span class="file">/usr/cygnus/</span><var>release</var></samp>, where <var>release</var> is the
name of the release, and to use a &lsquo;<samp><span class="samp">--exec-prefix</span></samp>&rsquo; option of
<samp><span class="file">/usr/cygnus/</span><var>release</var><span class="file">/H-</span><var>host</var></samp>, where <var>host</var> is the
configuration name of the host system (see <a href="#Configuration-Names">Configuration Names</a>).

   <p>Do not use either the source or the object directory as the installation
directory.  That will just lead to confusion.

<div class="node">
<a name="Getting-Started"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Files">Files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Introduction">Introduction</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">2 Getting Started</h2>

<p>To start using the GNU configure and build system with your software
package, you must write three files, and you must run some tools to
manually generate additional files.

<ul class="menu">
<li><a accesskey="1" href="#Write-configure_002ein">Write configure.in</a>: 		Write configure.in. 
<li><a accesskey="2" href="#Write-Makefile_002eam">Write Makefile.am</a>: 		Write Makefile.am. 
<li><a accesskey="3" href="#Write-acconfig_002eh">Write acconfig.h</a>: 		Write acconfig.h. 
<li><a accesskey="4" href="#Generate-files">Generate files</a>: 		Generate files. 
<li><a accesskey="5" href="#Getting-Started-Example">Getting Started Example</a>: 	Example. 
</ul>

<div class="node">
<a name="Write-configure.in"></a>
<a name="Write-configure_002ein"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Write-Makefile_002eam">Write Makefile.am</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-Started">Getting Started</a>

</div>

<h3 class="section">2.1 Write configure.in</h3>

<p><a name="index-g_t_0040file_007bconfigure_002ein_007d_002c-writing-3"></a>
You must first write the file <samp><span class="file">configure.in</span></samp>.  This is an autoconf
input file, and the autoconf manual describes in detail what this file
should look like.

   <p>You will write tests in your <samp><span class="file">configure.in</span></samp> file to check for
conditions that may change from one system to another, such as the
presence of particular header files or functions.

   <p>For example, not all systems support the &lsquo;<samp><span class="samp">gettimeofday</span></samp>&rsquo; function. 
If you want to use the &lsquo;<samp><span class="samp">gettimeofday</span></samp>&rsquo; function when it is
available, and to use some other function when it is not, you would
check for this by putting &lsquo;<samp><span class="samp">AC_CHECK_FUNCS(gettimeofday)</span></samp>&rsquo; in
<samp><span class="file">configure.in</span></samp>.

   <p>When the configure script is run at build time, this will arrange to
define the preprocessor macro &lsquo;<samp><span class="samp">HAVE_GETTIMEOFDAY</span></samp>&rsquo; to the value 1 if
the &lsquo;<samp><span class="samp">gettimeofday</span></samp>&rsquo; function is available, and to not define the
macro at all if the function is not available.  Your code can then use
&lsquo;<samp><span class="samp">#ifdef</span></samp>&rsquo; to test whether it is safe to call &lsquo;<samp><span class="samp">gettimeofday</span></samp>&rsquo;.

   <p>If you have an existing body of code, the &lsquo;<samp><span class="samp">autoscan</span></samp>&rsquo; program may
help identify potential portability problems, and hence configure tests
that you will want to use. 
See <a href="http://www.delorie.com/gnu/docs/autoconf/autoconf_4.html">the autoscan documentation</a>.

   <p>Another handy tool for an existing body of code is &lsquo;<samp><span class="samp">ifnames</span></samp>&rsquo;.  This
will show you all the preprocessor conditionals that the code already
uses. 
See <a href="http://www.delorie.com/gnu/docs/autoconf/autoconf_5.html">the ifnames documentation</a>.

   <p>Besides the portability tests which are specific to your particular
package, every <samp><span class="file">configure.in</span></samp> file should contain the following
macros.

     <dl>
<dt>&lsquo;<samp><span class="samp">AC_INIT</span></samp>&rsquo;<dd><a name="index-g_t_0040samp_007bAC_005fINIT_007d-4"></a>This macro takes a single argument, which is the name of a file in your
package.  For example, &lsquo;<samp><span class="samp">AC_INIT(foo.c)</span></samp>&rsquo;.

     <br><dt>&lsquo;<samp><span class="samp">AC_PREREQ(</span><var>VERSION</var><span class="samp">)</span></samp>&rsquo;<dd><a name="index-g_t_0040samp_007bAC_005fPREREQ_007d-5"></a>This macro is optional.  It may be used to indicate the version of
&lsquo;<samp><span class="samp">autoconf</span></samp>&rsquo; that you are using.  This will prevent users from
running an earlier version of &lsquo;<samp><span class="samp">autoconf</span></samp>&rsquo; and perhaps getting an
invalid <samp><span class="file">configure</span></samp> script.  For example, &lsquo;<samp><span class="samp">AC_PREREQ(2.12)</span></samp>&rsquo;.

     <br><dt>&lsquo;<samp><span class="samp">AM_INIT_AUTOMAKE</span></samp>&rsquo;<dd><a name="index-g_t_0040samp_007bAM_005fINIT_005fAUTOMAKE_007d-6"></a>This macro takes two arguments: the name of the package, and a version
number.  For example, &lsquo;<samp><span class="samp">AM_INIT_AUTOMAKE(foo, 1.0)</span></samp>&rsquo;.  (This macro is
not needed if you are not using automake).

     <br><dt>&lsquo;<samp><span class="samp">AM_CONFIG_HEADER</span></samp>&rsquo;<dd><a name="index-g_t_0040samp_007bAM_005fCONFIG_005fHEADER_007d-7"></a>This macro names the header file which will hold the preprocessor macro
definitions at run time.  Normally this should be <samp><span class="file">config.h</span></samp>.  Your
sources would then use &lsquo;<samp><span class="samp">#include "config.h"</span></samp>&rsquo; to include it.

     <p>This macro may optionally name the input file for that header file; by
default, this is <samp><span class="file">config.h.in</span></samp>, but that file name works poorly on
DOS filesystems.  Therefore, it is often better to name it explicitly as
<samp><span class="file">config.in</span></samp>.

     <p>This is what you should normally put in <samp><span class="file">configure.in</span></samp>:
     <pre class="example">          AM_CONFIG_HEADER(config.h:config.in)
</pre>
     <p><a name="index-g_t_0040samp_007bAC_005fCONFIG_005fHEADER_007d-8"></a>(If you are not using automake, use &lsquo;<samp><span class="samp">AC_CONFIG_HEADER</span></samp>&rsquo; rather than
&lsquo;<samp><span class="samp">AM_CONFIG_HEADER</span></samp>&rsquo;).

     <br><dt>&lsquo;<samp><span class="samp">AM_MAINTAINER_MODE</span></samp>&rsquo;<dd><a name="index-g_t_0040samp_007bAM_005fMAINTAINER_005fMODE_007d-9"></a>This macro always appears in Cygnus configure scripts.  Other programs
may or may not use it.

     <p>If this macro is used, the &lsquo;<samp><span class="samp">--enable-maintainer-mode</span></samp>&rsquo; option is
required to enable automatic rebuilding of generated files used by the
configure system.  This of course requires that developers be aware of,
and use, that option.

     <p>If this macro is not used, then the generated files will always be
rebuilt automatically.  This will cause problems if the wrong versions
of autoconf, automake, or others are in the builder's &lsquo;<samp><span class="samp">PATH</span></samp>&rsquo;.

     <p>(If you are not using automake, you do not need to use this macro).

     <br><dt>&lsquo;<samp><span class="samp">AC_EXEEXT</span></samp>&rsquo;<dd><a name="index-g_t_0040samp_007bAC_005fEXEEXT_007d-10"></a><a name="index-g_t_0040samp_007bAM_005fEXEEXT_007d-11"></a>Either this macro or &lsquo;<samp><span class="samp">AM_EXEEXT</span></samp>&rsquo; always appears in Cygnus configure
files.  Other programs may or may not use one of them.

     <p>This macro looks for the executable suffix used on the host system.  On
Unix systems, this is the empty string.  On Windows systems, this is
&lsquo;<samp><span class="samp">.exe</span></samp>&rsquo;.  This macro directs automake to use the executable suffix
as appropriate when creating programs.  This macro does not take any
arguments.

     <p>The &lsquo;<samp><span class="samp">AC_EXEEXT</span></samp>&rsquo; form is new, and is part of a Cygnus patch to
autoconf to support compiling with Visual C++.  Older programs use
&lsquo;<samp><span class="samp">AM_EXEEXT</span></samp>&rsquo; instead.

     <p>(Programs which do not use automake use neither &lsquo;<samp><span class="samp">AC_EXEEXT</span></samp>&rsquo; nor
&lsquo;<samp><span class="samp">AM_EXEEXT</span></samp>&rsquo;).

     <br><dt>&lsquo;<samp><span class="samp">AC_PROG_CC</span></samp>&rsquo;<dd><a name="index-g_t_0040samp_007bAC_005fPROG_005fCC_007d-12"></a>If you are writing C code, you will normally want to use this macro.  It
locates the C compiler to use.  It does not take any arguments.

     <p>However, if this <samp><span class="file">configure.in</span></samp> file is for a library which is to
be compiled by a cross compiler which may not fully work, then you will
not want to use &lsquo;<samp><span class="samp">AC_PROG_CC</span></samp>&rsquo;.  Instead, you will want to use a
variant which does not call the macro &lsquo;<samp><span class="samp">AC_PROG_CC_WORKS</span></samp>&rsquo;.  Examples
can be found in various <samp><span class="file">configure.in</span></samp> files for libraries that are
compiled with cross compilers, such as libiberty or libgloss.  This is
essentially a bug in autoconf, and there will probably be a better
workaround at some point.

     <br><dt>&lsquo;<samp><span class="samp">AC_PROG_CXX</span></samp>&rsquo;<dd><a name="index-g_t_0040samp_007bAC_005fPROG_005fCXX_007d-13"></a>If you are writing C++ code, you will want to use this macro.  It
locates the C++ compiler to use.  It does not take any arguments.  The
same cross compiler comments apply as for &lsquo;<samp><span class="samp">AC_PROG_CC</span></samp>&rsquo;.

     <br><dt>&lsquo;<samp><span class="samp">AM_PROG_LIBTOOL</span></samp>&rsquo;<dd><a name="index-g_t_0040samp_007bAM_005fPROG_005fLIBTOOL_007d-14"></a>If you want to build libraries, and you want to permit them to be
shared, or you want to link against libraries which were built using
libtool, then you will need this macro.  This macro is required in order
to use libtool.

     <p><a name="index-g_t_0040samp_007bAM_005fDISABLE_005fSHARED_007d-15"></a>By default, this will cause all libraries to be built as shared
libraries.  To prevent this&ndash;to change the default&ndash;use
&lsquo;<samp><span class="samp">AM_DISABLE_SHARED</span></samp>&rsquo; before &lsquo;<samp><span class="samp">AM_PROG_LIBTOOL</span></samp>&rsquo;.  The configure
options &lsquo;<samp><span class="samp">--enable-shared</span></samp>&rsquo; and &lsquo;<samp><span class="samp">--disable-shared</span></samp>&rsquo; may be used
to override the default at build time.

     <br><dt>&lsquo;<samp><span class="samp">AC_DEFINE(_GNU_SOURCE)</span></samp>&rsquo;<dd><a name="index-g_t_0040samp_007b_005fGNU_005fSOURCE_007d-16"></a>GNU packages should normally include this line before any other feature
tests.  This defines the macro &lsquo;<samp><span class="samp">_GNU_SOURCE</span></samp>&rsquo; when compiling, which
directs the libc header files to provide the standard GNU system
interfaces including all GNU extensions.  If this macro is not defined,
certain GNU extensions may not be available.

     <br><dt>&lsquo;<samp><span class="samp">AC_OUTPUT</span></samp>&rsquo;<dd><a name="index-g_t_0040samp_007bAC_005fOUTPUT_007d-17"></a>This macro takes a list of file names which the configure process should
produce.  This is normally a list of one or more <samp><span class="file">Makefile</span></samp> files
in different directories.  If your package lives entirely in a single
directory, you would use simply &lsquo;<samp><span class="samp">AC_OUTPUT(Makefile)</span></samp>&rsquo;.  If you also
have, for example, a <samp><span class="file">lib</span></samp> subdirectory, you would use
&lsquo;<samp><span class="samp">AC_OUTPUT(Makefile lib/Makefile)</span></samp>&rsquo;. 
</dl>

   <p>If you want to use locally defined macros in your <samp><span class="file">configure.in</span></samp>
file, then you will need to write a <samp><span class="file">acinclude.m4</span></samp> file which
defines them (if not using automake, this file is called
<samp><span class="file">aclocal.m4</span></samp>).  Alternatively, you can put separate macros in an
<samp><span class="file">m4</span></samp> subdirectory, and put &lsquo;<samp><span class="samp">ACLOCAL_AMFLAGS = -I m4</span></samp>&rsquo; in your
<samp><span class="file">Makefile.am</span></samp> file so that the &lsquo;<samp><span class="samp">aclocal</span></samp>&rsquo; program will be able
to find them.

   <p>The different macro prefixes indicate which tool defines the macro. 
Macros which start with &lsquo;<samp><span class="samp">AC_</span></samp>&rsquo; are part of autoconf.  Macros which
start with &lsquo;<samp><span class="samp">AM_</span></samp>&rsquo; are provided by automake or libtool.

<div class="node">
<a name="Write-Makefile.am"></a>
<a name="Write-Makefile_002eam"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Write-acconfig_002eh">Write acconfig.h</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Write-configure_002ein">Write configure.in</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-Started">Getting Started</a>

</div>

<h3 class="section">2.2 Write Makefile.am</h3>

<p><a name="index-g_t_0040file_007bMakefile_002eam_007d_002c-writing-18"></a>
You must write the file <samp><span class="file">Makefile.am</span></samp>.  This is an automake input
file, and the automake manual describes in detail what this file should
look like.

   <p>The automake commands in <samp><span class="file">Makefile.am</span></samp> mostly look like variable
assignments in a <samp><span class="file">Makefile</span></samp>.  automake recognizes special variable
names, and automatically add make rules to the output as needed.

   <p>There will be one <samp><span class="file">Makefile.am</span></samp> file for each directory in your
package.  For each directory with subdirectories, the <samp><span class="file">Makefile.am</span></samp>
file should contain the line
<pre class="smallexample">     SUBDIRS = <var>dir</var> <var>dir</var> ...
</pre>
   <p class="noindent">where each <var>dir</var> is the name of a subdirectory.

   <p>For each <samp><span class="file">Makefile.am</span></samp>, there should be a corresponding
<samp><span class="file">Makefile</span></samp> in the &lsquo;<samp><span class="samp">AC_OUTPUT</span></samp>&rsquo; macro in <samp><span class="file">configure.in</span></samp>.

   <p>Every <samp><span class="file">Makefile.am</span></samp> written at Cygnus should contain the line
<pre class="smallexample">     AUTOMAKE_OPTIONS = cygnus
</pre>
   <p class="noindent">This puts automake into Cygnus mode.  See the automake manual for
details.

   <p>You may to include the version number of &lsquo;<samp><span class="samp">automake</span></samp>&rsquo; that you are
using on the &lsquo;<samp><span class="samp">AUTOMAKE_OPTIONS</span></samp>&rsquo; line.  For example,
<pre class="smallexample">     AUTOMAKE_OPTIONS = cygnus 1.3
</pre>
   <p class="noindent">This will prevent users from running an earlier version of
&lsquo;<samp><span class="samp">automake</span></samp>&rsquo; and perhaps getting an invalid <samp><span class="file">Makefile.in</span></samp>.

   <p>If your package builds a program, then in the directory where that
program is built you will normally want a line like
<pre class="smallexample">     bin_PROGRAMS = <var>program</var>
</pre>
   <p class="noindent">where <var>program</var> is the name of the program.  You will then want a
line like
<pre class="smallexample">     <var>program</var>_SOURCES = <var>file</var> <var>file</var> ...
</pre>
   <p class="noindent">where each <var>file</var> is the name of a source file to link into the
program (e.g., &lsquo;<samp><span class="samp">foo.c</span></samp>&rsquo;).

   <p>If your package builds a library, and you do not want the library to
ever be built as a shared library, then in the directory where that
library is built you will normally want a line like
<pre class="smallexample">     lib_LIBRARIES = lib<var>name</var>.a
</pre>
   <p class="noindent">where &lsquo;<samp><span class="samp">lib</span><var>name</var><span class="samp">.a</span></samp>&rsquo; is the name of the library.  You will then
want a line like
<pre class="smallexample">     lib<var>name</var>_a_SOURCES = <var>file</var> <var>file</var> ...
</pre>
   <p class="noindent">where each <var>file</var> is the name of a source file to add to the
library.

   <p>If your package builds a library, and you want to permit building the
library as a shared library, then in the directory where that library is
built you will normally want a line like
<pre class="smallexample">     lib_LTLIBRARIES = lib<var>name</var>.la
</pre>
   <p>The use of &lsquo;<samp><span class="samp">LTLIBRARIES</span></samp>&rsquo;, and the &lsquo;<samp><span class="samp">.la</span></samp>&rsquo; extension, indicate a
library to be built using libtool.  As usual, you will then want a line
like
<pre class="smallexample">     lib<var>name</var>_la_SOURCES = <var>file</var> <var>file</var> ...
</pre>
   <p>The strings &lsquo;<samp><span class="samp">bin</span></samp>&rsquo; and &lsquo;<samp><span class="samp">lib</span></samp>&rsquo; that appear above in
&lsquo;<samp><span class="samp">bin_PROGRAMS</span></samp>&rsquo; and &lsquo;<samp><span class="samp">lib_LIBRARIES</span></samp>&rsquo; are not arbitrary.  They
refer to particular directories, which may be set by the &lsquo;<samp><span class="samp">--bindir</span></samp>&rsquo;
and &lsquo;<samp><span class="samp">--libdir</span></samp>&rsquo; options to <samp><span class="file">configure</span></samp>.  If those options are
not used, the default values are based on the &lsquo;<samp><span class="samp">--prefix</span></samp>&rsquo; or
&lsquo;<samp><span class="samp">--exec-prefix</span></samp>&rsquo; options to <samp><span class="file">configure</span></samp>.  It is possible to use
other names if the program or library should be installed in some other
directory.

   <p>The <samp><span class="file">Makefile.am</span></samp> file may also contain almost anything that may
appear in a normal <samp><span class="file">Makefile</span></samp>.  automake also supports many other
special variables, as well as conditionals.

   <p>See the automake manual for more information.

<div class="node">
<a name="Write-acconfig.h"></a>
<a name="Write-acconfig_002eh"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Generate-files">Generate files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Write-Makefile_002eam">Write Makefile.am</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-Started">Getting Started</a>

</div>

<h3 class="section">2.3 Write acconfig.h</h3>

<p><a name="index-g_t_0040file_007bacconfig_002eh_007d_002c-writing-19"></a>
If you are generating a portability header file, (i.e., you are using
&lsquo;<samp><span class="samp">AM_CONFIG_HEADER</span></samp>&rsquo; in <samp><span class="file">configure.in</span></samp>), then you will have to
write a <samp><span class="file">acconfig.h</span></samp> file.  It will have to contain the following
lines.

<pre class="smallexample">     /* Name of package.  */
     #undef PACKAGE
     
     /* Version of package.  */
     #undef VERSION
</pre>
   <p>This requirement is really a bug in the system, and the requirement may
be eliminated at some later date.

   <p>The <samp><span class="file">acconfig.h</span></samp> file will also similar comment and &lsquo;<samp><span class="samp">#undef</span></samp>&rsquo;
lines for any unusual macros in the <samp><span class="file">configure.in</span></samp> file, including
any macro which appears in a &lsquo;<samp><span class="samp">AC_DEFINE</span></samp>&rsquo; macro.

   <p>In particular, if you are writing a GNU package and therefore include
&lsquo;<samp><span class="samp">AC_DEFINE(_GNU_SOURCE)</span></samp>&rsquo; in <samp><span class="file">configure.in</span></samp> as suggested above,
you will need lines like this in <samp><span class="file">acconfig.h</span></samp>:
<pre class="smallexample">     /* Enable GNU extensions.  */
     #undef _GNU_SOURCE
</pre>
   <p>Normally the &lsquo;<samp><span class="samp">autoheader</span></samp>&rsquo; program will inform you of any such
requirements by printing an error message when it is run.  However, if
you do anything particular odd in your <samp><span class="file">configure.in</span></samp> file, you
will have to make sure that the right entries appear in
<samp><span class="file">acconfig.h</span></samp>, since otherwise the results of the tests may not be
available in the <samp><span class="file">config.h</span></samp> file which your code will use.

   <p>(Thee &lsquo;<samp><span class="samp">PACKAGE</span></samp>&rsquo; and &lsquo;<samp><span class="samp">VERSION</span></samp>&rsquo; lines are not required if you
are not using automake, and in that case you may not need a
<samp><span class="file">acconfig.h</span></samp> file at all).

<div class="node">
<a name="Generate-files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Getting-Started-Example">Getting Started Example</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Write-acconfig_002eh">Write acconfig.h</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-Started">Getting Started</a>

</div>

<h3 class="section">2.4 Generate files</h3>

<p>Once you have written <samp><span class="file">configure.in</span></samp>, <samp><span class="file">Makefile.am</span></samp>,
<samp><span class="file">acconfig.h</span></samp>, and possibly <samp><span class="file">acinclude.m4</span></samp>, you must use
autoconf and automake programs to produce the first versions of the
generated files.  This is done by executing the following sequence of
commands.

<pre class="smallexample">     aclocal
     autoconf
     autoheader
     automake
</pre>
   <p>The &lsquo;<samp><span class="samp">aclocal</span></samp>&rsquo; and &lsquo;<samp><span class="samp">automake</span></samp>&rsquo; commands are part of the automake
package, and the &lsquo;<samp><span class="samp">autoconf</span></samp>&rsquo; and &lsquo;<samp><span class="samp">autoheader</span></samp>&rsquo; commands are part
of the autoconf package.

   <p>If you are using a <samp><span class="file">m4</span></samp> subdirectory for your macros, you will need
to use the &lsquo;<samp><span class="samp">-I m4</span></samp>&rsquo; option when you run &lsquo;<samp><span class="samp">aclocal</span></samp>&rsquo;.

   <p>If you are not using the Cygnus tree, use the &lsquo;<samp><span class="samp">-a</span></samp>&rsquo; option when
running &lsquo;<samp><span class="samp">automake</span></samp>&rsquo; command in order to copy the required support
files into your source directory.

   <p>If you are using libtool, you must build and install the libtool package
with the same &lsquo;<samp><span class="samp">--prefix</span></samp>&rsquo; and &lsquo;<samp><span class="samp">--exec-prefix</span></samp>&rsquo; options as you
used with the autoconf and automake packages.  You must do this before
running any of the above commands.  If you are not using the Cygnus
tree, you will need to run the &lsquo;<samp><span class="samp">libtoolize</span></samp>&rsquo; program to copy the
libtool support files into your directory.

   <p>Once you have managed to run these commands without getting any errors,
you should create a new empty directory, and run the &lsquo;<samp><span class="samp">configure</span></samp>&rsquo;
script which will have been created by &lsquo;<samp><span class="samp">autoconf</span></samp>&rsquo; with the
&lsquo;<samp><span class="samp">--enable-maintainer-mode</span></samp>&rsquo; option.  This will give you a set of
Makefiles which will include rules to automatically rebuild all the
generated files.

   <p>After doing that, whenever you have changed some of the input files and
want to regenerated the other files, go to your object directory and run
&lsquo;<samp><span class="samp">make</span></samp>&rsquo;.  Doing this is more reliable than trying to rebuild the
files manually, because there are complex order dependencies and it is
easy to forget something.

<div class="node">
<a name="Getting-Started-Example"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Generate-files">Generate files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-Started">Getting Started</a>

</div>

<h3 class="section">2.5 Example</h3>

<p>Let's consider a trivial example.

   <p>Suppose we want to write a simple version of &lsquo;<samp><span class="samp">touch</span></samp>&rsquo;.  Our program,
which we will call &lsquo;<samp><span class="samp">poke</span></samp>&rsquo;, will take a single file name argument,
and use the &lsquo;<samp><span class="samp">utime</span></samp>&rsquo; system call to set the modification and access
times of the file to the current time.  We want this program to be
highly portable.

   <p>We'll first see what this looks like without using autoconf and
automake, and then see what it looks like with them.

<ul class="menu">
<li><a accesskey="1" href="#Getting-Started-Example-1">Getting Started Example 1</a>: 		First Try. 
<li><a accesskey="2" href="#Getting-Started-Example-2">Getting Started Example 2</a>: 		Second Try. 
<li><a accesskey="3" href="#Getting-Started-Example-3">Getting Started Example 3</a>: 		Third Try. 
<li><a accesskey="4" href="#Generate-Files-in-Example">Generate Files in Example</a>: 		Generate Files. 
</ul>

<div class="node">
<a name="Getting-Started-Example-1"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Getting-Started-Example-2">Getting Started Example 2</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-Started-Example">Getting Started Example</a>

</div>

<h4 class="subsection">2.5.1 First Try</h4>

<p>Here is our first try at &lsquo;<samp><span class="samp">poke.c</span></samp>&rsquo;.  Note that we've written it
without ANSI/ISO C prototypes, since we want it to be highly portable.

<pre class="example">     #include &lt;stdio.h&gt;
     #include &lt;stdlib.h&gt;
     #include &lt;sys/types.h&gt;
     #include &lt;utime.h&gt;
     
     int
     main (argc, argv)
          int argc;
          char **argv;
     {
       if (argc != 2)
         {
           fprintf (stderr, "Usage: poke file\n");
           exit (1);
         }
     
       if (utime (argv[1], NULL) &lt; 0)
         {
           perror ("utime");
           exit (1);
         }
     
       exit (0);
     }
</pre>
   <p>We also write a simple <samp><span class="file">Makefile</span></samp>.

<pre class="example">     CC = gcc
     CFLAGS = -g -O2
     
     all: poke
     
     poke: poke.o
     	$(CC) -o poke $(CFLAGS) $(LDFLAGS) poke.o
</pre>
   <p>So far, so good.

   <p>Unfortunately, there are a few problems.

   <p>On older Unix systems derived from BSD 4.3, the &lsquo;<samp><span class="samp">utime</span></samp>&rsquo; system call
does not accept a second argument of &lsquo;<samp><span class="samp">NULL</span></samp>&rsquo;.  On those systems, we
need to pass a pointer to &lsquo;<samp><span class="samp">struct utimbuf</span></samp>&rsquo; structure. 
Unfortunately, even older systems don't define that structure; on those
systems, we need to pass an array of two &lsquo;<samp><span class="samp">long</span></samp>&rsquo; values.

   <p>The header file <samp><span class="file">stdlib.h</span></samp> was invented by ANSI C, and older
systems don't have a copy.  We included it above to get a declaration of
&lsquo;<samp><span class="samp">exit</span></samp>&rsquo;.

   <p>We can find some of these portability problems by running
&lsquo;<samp><span class="samp">autoscan</span></samp>&rsquo;, which will create a <samp><span class="file">configure.scan</span></samp> file which we
can use as a prototype for our <samp><span class="file">configure.in</span></samp> file.  I won't show
the output, but it will notice the potential problems with &lsquo;<samp><span class="samp">utime</span></samp>&rsquo;
and <samp><span class="file">stdlib.h</span></samp>.

   <p>In our <samp><span class="file">Makefile</span></samp>, we don't provide any way to install the program. 
This doesn't matter much for such a simple example, but a real program
will need an &lsquo;<samp><span class="samp">install</span></samp>&rsquo; target.  For that matter, we will also want
a &lsquo;<samp><span class="samp">clean</span></samp>&rsquo; target.

<div class="node">
<a name="Getting-Started-Example-2"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Getting-Started-Example-3">Getting Started Example 3</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Getting-Started-Example-1">Getting Started Example 1</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-Started-Example">Getting Started Example</a>

</div>

<h4 class="subsection">2.5.2 Second Try</h4>

<p>Here is our second try at this program.

   <p>We modify <samp><span class="file">poke.c</span></samp> to use preprocessor macros to control what
features are available.  (I've cheated a bit by using the same macro
names which autoconf will use).

<pre class="example">     #include &lt;stdio.h&gt;
     
     #ifdef STDC_HEADERS
     #include &lt;stdlib.h&gt;
     #endif
     
     #include &lt;sys/types.h&gt;
     
     #ifdef HAVE_UTIME_H
     #include &lt;utime.h&gt;
     #endif
     
     #ifndef HAVE_UTIME_NULL
     
     #include &lt;time.h&gt;
     
     #ifndef HAVE_STRUCT_UTIMBUF
     
     struct utimbuf
     {
       long actime;
       long modtime;
     };
     
     #endif
     
     static int
     utime_now (file)
          char *file;
     {
       struct utimbuf now;
     
       now.actime = now.modtime = time (NULL);
       return utime (file, &amp;now);
     }
     
     #define utime(f, p) utime_now (f)
     
     #endif /* HAVE_UTIME_NULL  */
     
     int
     main (argc, argv)
          int argc;
          char **argv;
     {
       if (argc != 2)
         {
           fprintf (stderr, "Usage: poke file\n");
           exit (1);
         }
     
       if (utime (argv[1], NULL) &lt; 0)
         {
           perror ("utime");
           exit (1);
         }
     
       exit (0);
     }
</pre>
   <p>Here is the associated <samp><span class="file">Makefile</span></samp>.  We've added support for the
preprocessor flags we use.  We've also added &lsquo;<samp><span class="samp">install</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">clean</span></samp>&rsquo; targets.

<pre class="example">     # Set this to your installation directory.
     bindir = /usr/local/bin
     
     # Uncomment this if you have the standard ANSI/ISO C header files.
     # STDC_HDRS = -DSTDC_HEADERS
     
     # Uncomment this if you have utime.h.
     # UTIME_H = -DHAVE_UTIME_H
     
     # Uncomment this if utime (FILE, NULL) works on your system.
     # UTIME_NULL = -DHAVE_UTIME_NULL
     
     # Uncomment this if struct utimbuf is defined in utime.h.
     # UTIMBUF = -DHAVE_STRUCT_UTIMBUF
     
     CC = gcc
     CFLAGS = -g -O2
     
     ALL_CFLAGS = $(STDC_HDRS) $(UTIME_H) $(UTIME_NULL) $(UTIMBUF) $(CFLAGS)
     
     all: poke
     
     poke: poke.o
     	$(CC) -o poke $(ALL_CFLAGS) $(LDFLAGS) poke.o
     
     .c.o:
     	$(CC) -c $(ALL_CFLAGS) poke.c
     
     install: poke
     	cp poke $(bindir)/poke
     
     clean:
     	rm poke poke.o
</pre>
   <p>Some problems with this approach should be clear.

   <p>Users who want to compile poke will have to know how &lsquo;<samp><span class="samp">utime</span></samp>&rsquo; works
on their systems, so that they can uncomment the <samp><span class="file">Makefile</span></samp>
correctly.

   <p>The installation is done using &lsquo;<samp><span class="samp">cp</span></samp>&rsquo;, but many systems have an
&lsquo;<samp><span class="samp">install</span></samp>&rsquo; program which may be used, and which supports optional
features such as stripping debugging information out of the installed
binary.

   <p>The use of <samp><span class="file">Makefile</span></samp> variables like &lsquo;<samp><span class="samp">CC</span></samp>&rsquo;, &lsquo;<samp><span class="samp">CFLAGS</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">LDFLAGS</span></samp>&rsquo; follows the requirements of the GNU standards.  This is
convenient for all packages, since it reduces surprises for users. 
However, it is easy to get the details wrong, and wind up with a
slightly nonstandard distribution.

<div class="node">
<a name="Getting-Started-Example-3"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Generate-Files-in-Example">Generate Files in Example</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Getting-Started-Example-2">Getting Started Example 2</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-Started-Example">Getting Started Example</a>

</div>

<h4 class="subsection">2.5.3 Third Try</h4>

<p>For our third try at this program, we will write a <samp><span class="file">configure.in</span></samp>
script to discover the configuration features on the host system, rather
than requiring the user to edit the <samp><span class="file">Makefile</span></samp>.  We will also write
a <samp><span class="file">Makefile.am</span></samp> rather than a <samp><span class="file">Makefile</span></samp>.

   <p>The only change to <samp><span class="file">poke.c</span></samp> is to add a line at the start of the
file:
<pre class="smallexample">     #include "config.h"
</pre>
   <p>The new <samp><span class="file">configure.in</span></samp> file is as follows.

<pre class="example">     AC_INIT(poke.c)
     AM_INIT_AUTOMAKE(poke, 1.0)
     AM_CONFIG_HEADER(config.h:config.in)
     AC_PROG_CC
     AC_HEADER_STDC
     AC_CHECK_HEADERS(utime.h)
     AC_EGREP_HEADER(utimbuf, utime.h, AC_DEFINE(HAVE_STRUCT_UTIMBUF))
     AC_FUNC_UTIME_NULL
     AC_OUTPUT(Makefile)
</pre>
   <p>The first four macros in this file, and the last one, were described
above; see <a href="#Write-configure_002ein">Write configure.in</a>.  If we omit these macros, then when
we run &lsquo;<samp><span class="samp">automake</span></samp>&rsquo; we will get a reminder that we need them.

   <p>The other macros are standard autoconf macros.

     <dl>
<dt>&lsquo;<samp><span class="samp">AC_HEADER_STDC</span></samp>&rsquo;<dd>Check for standard C headers. 
<br><dt>&lsquo;<samp><span class="samp">AC_CHECK_HEADERS</span></samp>&rsquo;<dd>Check whether a particular header file exists. 
<br><dt>&lsquo;<samp><span class="samp">AC_EGREP_HEADER</span></samp>&rsquo;<dd>Check for a particular string in a particular header file, in this case
checking for &lsquo;<samp><span class="samp">utimbuf</span></samp>&rsquo; in <samp><span class="file">utime.h</span></samp>. 
<br><dt>&lsquo;<samp><span class="samp">AC_FUNC_UTIME_NULL</span></samp>&rsquo;<dd>Check whether &lsquo;<samp><span class="samp">utime</span></samp>&rsquo; accepts a NULL second argument to set the
file change time to the current time. 
</dl>

   <p>See the autoconf manual for a more complete description.

   <p>The new <samp><span class="file">Makefile.am</span></samp> file is as follows.  Note how simple this is
compared to our earlier <samp><span class="file">Makefile</span></samp>.

<pre class="example">     bin_PROGRAMS = poke
     
     poke_SOURCES = poke.c
</pre>
   <p>This means that we should build a single program name &lsquo;<samp><span class="samp">poke</span></samp>&rsquo;.  It
should be installed in the binary directory, which we called
&lsquo;<samp><span class="samp">bindir</span></samp>&rsquo; earlier.  The program &lsquo;<samp><span class="samp">poke</span></samp>&rsquo; is built from the source
file <samp><span class="file">poke.c</span></samp>.

   <p>We must also write a <samp><span class="file">acconfig.h</span></samp> file.  Besides &lsquo;<samp><span class="samp">PACKAGE</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">VERSION</span></samp>&rsquo;, which must be mentioned for all packages which use
automake, we must include &lsquo;<samp><span class="samp">HAVE_STRUCT_UTIMBUF</span></samp>&rsquo;, since we mentioned
it in an &lsquo;<samp><span class="samp">AC_DEFINE</span></samp>&rsquo;.

<pre class="example">     /* Name of package.  */
     #undef PACKAGE
     
     /* Version of package.  */
     #undef VERSION
     
     /* Whether utime.h defines struct utimbuf.  */
     #undef HAVE_STRUCT_UTIMBUF
</pre>
   <div class="node">
<a name="Generate-Files-in-Example"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Getting-Started-Example-3">Getting Started Example 3</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Getting-Started-Example">Getting Started Example</a>

</div>

<h4 class="subsection">2.5.4 Generate Files</h4>

<p>We must now generate the other files, using the following commands.

<pre class="smallexample">     aclocal
     autoconf
     autoheader
     automake
</pre>
   <p>When we run &lsquo;<samp><span class="samp">autoheader</span></samp>&rsquo;, it will remind us of any macros we forgot
to add to <samp><span class="file">acconfig.h</span></samp>.

   <p>When we run &lsquo;<samp><span class="samp">automake</span></samp>&rsquo;, it will want to add some files to our
distribution.  It will add them automatically if we use the
&lsquo;<samp><span class="samp">--add-missing</span></samp>&rsquo; option.

   <p>By default, &lsquo;<samp><span class="samp">automake</span></samp>&rsquo; will run in GNU mode, which means that it
will want us to create certain additional files; as of this writing, it
will want <samp><span class="file">NEWS</span></samp>, <samp><span class="file">README</span></samp>, <samp><span class="file">AUTHORS</span></samp>, and
<samp><span class="file">ChangeLog</span></samp>, all of which are files which should appear in a
standard GNU distribution.  We can either add those files, or run
&lsquo;<samp><span class="samp">automake</span></samp>&rsquo; with the &lsquo;<samp><span class="samp">--foreign</span></samp>&rsquo; option.

   <p>Running these tools will generate the following files, all of which are
described in the next chapter.

     <ul>
<li><samp><span class="file">aclocal.m4</span></samp>
<li><samp><span class="file">configure</span></samp>
<li><samp><span class="file">config.in</span></samp>
<li><samp><span class="file">Makefile.in</span></samp>
<li><samp><span class="file">stamp-h.in</span></samp>
</ul>

<div class="node">
<a name="Files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Configuration-Names">Configuration Names</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Getting-Started">Getting Started</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">3 Files</h2>

<p>As was seen in the previous chapter, the GNU configure and build system
uses a number of different files.  The developer must write a few files. 
The others are generated by various tools.

   <p>The system is rather flexible, and can be used in many different ways. 
In describing the files that it uses, I will describe the common case,
and mention some other cases that may arise.

<ul class="menu">
<li><a accesskey="1" href="#Developer-Files">Developer Files</a>: 		Developer Files. 
<li><a accesskey="2" href="#Build-Files">Build Files</a>: 			Build Files. 
<li><a accesskey="3" href="#Support-Files">Support Files</a>: 		Support Files. 
</ul>

<div class="node">
<a name="Developer-Files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Build-Files">Build Files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Files">Files</a>

</div>

<h3 class="section">3.1 Developer Files</h3>

<p>This section describes the files written or generated by the developer
of a package.

<ul class="menu">
<li><a accesskey="1" href="#Developer-Files-Picture">Developer Files Picture</a>: 	Developer Files Picture. 
<li><a accesskey="2" href="#Written-Developer-Files">Written Developer Files</a>: 	Written Developer Files. 
<li><a accesskey="3" href="#Generated-Developer-Files">Generated Developer Files</a>: 	Generated Developer Files. 
</ul>

<div class="node">
<a name="Developer-Files-Picture"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Written-Developer-Files">Written Developer Files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Developer-Files">Developer Files</a>

</div>

<h4 class="subsection">3.1.1 Developer Files Picture</h4>

<p>Here is a picture of the files which are written by the developer, the
generated files which would be included with a complete source
distribution, and the tools which create those files. 
The file names are in rectangles with square corners and the tool names
are in rectangles with rounded corners
(e.g., &lsquo;<samp><span class="samp">autoheader</span></samp>&rsquo; is the name of a tool, not the name of a file).

   <div class="block-image"><img src="configdev.jpg" alt="configdev.jpg"></div>

<div class="node">
<a name="Written-Developer-Files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Generated-Developer-Files">Generated Developer Files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Developer-Files-Picture">Developer Files Picture</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Developer-Files">Developer Files</a>

</div>

<h4 class="subsection">3.1.2 Written Developer Files</h4>

<p>The following files would be written by the developer.

     <dl>
<dt><samp><span class="file">configure.in</span></samp><dd><a name="index-g_t_0040file_007bconfigure_002ein_007d-20"></a>This is the configuration script.  This script contains invocations of
autoconf macros.  It may also contain ordinary shell script code.  This
file will contain feature tests for portability issues.  The last thing
in the file will normally be an &lsquo;<samp><span class="samp">AC_OUTPUT</span></samp>&rsquo; macro listing which
files to create when the builder runs the configure script.  This file
is always required when using the GNU configure system.  See <a href="#Write-configure_002ein">Write configure.in</a>.

     <br><dt><samp><span class="file">Makefile.am</span></samp><dd><a name="index-g_t_0040file_007bMakefile_002eam_007d-21"></a>This is the automake input file.  It describes how the code should be
built.  It consists of definitions of automake variables.  It may also
contain ordinary Makefile targets.  This file is only needed when using
automake (newer tools normally use automake, but there are still older
tools which have not been converted, in which the developer writes
<samp><span class="file">Makefile.in</span></samp> directly).  See <a href="#Write-Makefile_002eam">Write Makefile.am</a>.

     <br><dt><samp><span class="file">acconfig.h</span></samp><dd><a name="index-g_t_0040file_007bacconfig_002eh_007d-22"></a>When the configure script creates a portability header file, by using
&lsquo;<samp><span class="samp">AM_CONFIG_HEADER</span></samp>&rsquo; (or, if not using automake,
&lsquo;<samp><span class="samp">AC_CONFIG_HEADER</span></samp>&rsquo;), this file is used to describe macros which are
not recognized by the &lsquo;<samp><span class="samp">autoheader</span></samp>&rsquo; command.  This is normally a
fairly uninteresting file, consisting of a collection of &lsquo;<samp><span class="samp">#undef</span></samp>&rsquo;
lines with comments.  Normally any call to &lsquo;<samp><span class="samp">AC_DEFINE</span></samp>&rsquo; in
<samp><span class="file">configure.in</span></samp> will require a line in this file. See <a href="#Write-acconfig_002eh">Write acconfig.h</a>.

     <br><dt><samp><span class="file">acinclude.m4</span></samp><dd><a name="index-g_t_0040file_007bacinclude_002em4_007d-23"></a>This file is not always required.  It defines local autoconf macros. 
These macros may then be used in <samp><span class="file">configure.in</span></samp>.  If you don't need
any local autoconf macros, then you don't need this file at all.  In
fact, in general, you never need local autoconf macros, since you can
put everything in <samp><span class="file">configure.in</span></samp>, but sometimes a local macro is
convenient.

     <p>Newer tools may omit <samp><span class="file">acinclude.m4</span></samp>, and instead use a
subdirectory, typically named <samp><span class="file">m4</span></samp>, and define
&lsquo;<samp><span class="samp">ACLOCAL_AMFLAGS = -I m4</span></samp>&rsquo; in <samp><span class="file">Makefile.am</span></samp> to force
&lsquo;<samp><span class="samp">aclocal</span></samp>&rsquo; to look there for macro definitions.  The macro
definitions are then placed in separate files in that directory.

     <p>The <samp><span class="file">acinclude.m4</span></samp> file is only used when using automake; in older
tools, the developer writes <samp><span class="file">aclocal.m4</span></samp> directly, if it is needed. 
</dl>

<div class="node">
<a name="Generated-Developer-Files"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Written-Developer-Files">Written Developer Files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Developer-Files">Developer Files</a>

</div>

<h4 class="subsection">3.1.3 Generated Developer Files</h4>

<p>The following files would be generated by the developer.

   <p>When using automake, these files are normally not generated manually
after the first time.  Instead, the generated <samp><span class="file">Makefile</span></samp> contains
rules to automatically rebuild the files as required.  When
&lsquo;<samp><span class="samp">AM_MAINTAINER_MODE</span></samp>&rsquo; is used in <samp><span class="file">configure.in</span></samp> (the normal
case in Cygnus code), the automatic rebuilding rules will only be
defined if you configure using the &lsquo;<samp><span class="samp">--enable-maintainer-mode</span></samp>&rsquo;
option.

   <p>When using automatic rebuilding, it is important to ensure that all the
various tools have been built and installed on your &lsquo;<samp><span class="samp">PATH</span></samp>&rsquo;.  Using
automatic rebuilding is highly recommended, so much so that I'm not
going to explain what you have to do if you don't use it.

     <dl>
<dt><samp><span class="file">configure</span></samp><dd><a name="index-g_t_0040file_007bconfigure_007d-24"></a>This is the configure script which will be run when building the
package.  This is generated by &lsquo;<samp><span class="samp">autoconf</span></samp>&rsquo; from <samp><span class="file">configure.in</span></samp>
and <samp><span class="file">aclocal.m4</span></samp>.  This is a shell script.

     <br><dt><samp><span class="file">Makefile.in</span></samp><dd><a name="index-g_t_0040file_007bMakefile_002ein_007d-25"></a>This is the file which the configure script will turn into the
<samp><span class="file">Makefile</span></samp> at build time.  This file is generated by
&lsquo;<samp><span class="samp">automake</span></samp>&rsquo; from <samp><span class="file">Makefile.am</span></samp>.  If you aren't using automake,
you must write this file yourself.  This file is pretty much a normal
<samp><span class="file">Makefile</span></samp>, with some configure substitutions for certain
variables.

     <br><dt><samp><span class="file">aclocal.m4</span></samp><dd><a name="index-g_t_0040file_007baclocal_002em4_007d-26"></a>This file is created by the &lsquo;<samp><span class="samp">aclocal</span></samp>&rsquo; program, based on the
contents of <samp><span class="file">configure.in</span></samp> and <samp><span class="file">acinclude.m4</span></samp> (or, as noted in
the description of <samp><span class="file">acinclude.m4</span></samp> above, on the contents of an
<samp><span class="file">m4</span></samp> subdirectory).  This file contains definitions of autoconf
macros which &lsquo;<samp><span class="samp">autoconf</span></samp>&rsquo; will use when generating the file
<samp><span class="file">configure</span></samp>.  These autoconf macros may be defined by you in
<samp><span class="file">acinclude.m4</span></samp> or they may be defined by other packages such as
automake, libtool or gettext.  If you aren't using automake, you will
normally write this file yourself; in that case, if <samp><span class="file">configure.in</span></samp>
uses only standard autoconf macros, this file will not be needed at all.

     <br><dt><samp><span class="file">config.in</span></samp><dd><a name="index-g_t_0040file_007bconfig_002ein_007d-27"></a><a name="index-g_t_0040file_007bconfig_002eh_002ein_007d-28"></a>This file is created by &lsquo;<samp><span class="samp">autoheader</span></samp>&rsquo; based on <samp><span class="file">acconfig.h</span></samp> and
<samp><span class="file">configure.in</span></samp>.  At build time, the configure script will define
some of the macros in it to create <samp><span class="file">config.h</span></samp>, which may then be
included by your program.  This permits your C code to use preprocessor
conditionals to change its behaviour based on the characteristics of the
host system.  This file may also be called <samp><span class="file">config.h.in</span></samp>.

     <br><dt><samp><span class="file">stamp.h-in</span></samp><dd><a name="index-g_t_0040file_007bstamp_002dh_002ein_007d-29"></a>This rather uninteresting file, which I omitted from the picture, is
generated by &lsquo;<samp><span class="samp">automake</span></samp>&rsquo;.  It always contains the string
&lsquo;<samp><span class="samp">timestamp</span></samp>&rsquo;.  It is used as a timestamp file indicating whether
<samp><span class="file">config.in</span></samp> is up to date.  Using a timestamp file means that
<samp><span class="file">config.in</span></samp> can be marked as up to date without actually changing
its modification time.  This is useful since <samp><span class="file">config.in</span></samp> depends
upon <samp><span class="file">configure.in</span></samp>, but it is easy to change <samp><span class="file">configure.in</span></samp>
in a way which does not affect <samp><span class="file">config.in</span></samp>. 
</dl>

<div class="node">
<a name="Build-Files"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Support-Files">Support Files</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Developer-Files">Developer Files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Files">Files</a>

</div>

<h3 class="section">3.2 Build Files</h3>

<p>This section describes the files which are created at configure and
build time.  These are the files which somebody who builds the package
will see.

   <p>Of course, the developer will also build the package.  The distinction
between developer files and build files is not that the developer does
not see the build files, but that somebody who only builds the package
does not have to worry about the developer files.

<ul class="menu">
<li><a accesskey="1" href="#Build-Files-Picture">Build Files Picture</a>: 		Build Files Picture. 
<li><a accesskey="2" href="#Build-Files-Description">Build Files Description</a>: 	Build Files Description. 
</ul>

<div class="node">
<a name="Build-Files-Picture"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Build-Files-Description">Build Files Description</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Build-Files">Build Files</a>

</div>

<h4 class="subsection">3.2.1 Build Files Picture</h4>

<p>Here is a picture of the files which will be created at build time. 
<samp><span class="file">config.status</span></samp> is both a created file and a shell script which is
run to create other files, and the picture attempts to show that.

   <div class="block-image"><img src="configbuild.jpg" alt="configbuild.jpg"></div>

<div class="node">
<a name="Build-Files-Description"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Build-Files-Picture">Build Files Picture</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Build-Files">Build Files</a>

</div>

<h4 class="subsection">3.2.2 Build Files Description</h4>

<p>This is a description of the files which are created at build time.

     <dl>
<dt><samp><span class="file">config.status</span></samp><dd><a name="index-g_t_0040file_007bconfig_002estatus_007d-30"></a>The first step in building a package is to run the <samp><span class="file">configure</span></samp>
script.  The <samp><span class="file">configure</span></samp> script will create the file
<samp><span class="file">config.status</span></samp>, which is itself a shell script.  When you first
run <samp><span class="file">configure</span></samp>, it will automatically run <samp><span class="file">config.status</span></samp>. 
An <samp><span class="file">Makefile</span></samp> derived from an automake generated <samp><span class="file">Makefile.in</span></samp>
will contain rules to automatically run <samp><span class="file">config.status</span></samp> again when
necessary to recreate certain files if their inputs change.

     <br><dt><samp><span class="file">Makefile</span></samp><dd><a name="index-g_t_0040file_007bMakefile_007d-31"></a>This is the file which make will read to build the program.  The
<samp><span class="file">config.status</span></samp> script will transform <samp><span class="file">Makefile.in</span></samp> into
<samp><span class="file">Makefile</span></samp>.

     <br><dt><samp><span class="file">config.h</span></samp><dd><a name="index-g_t_0040file_007bconfig_002eh_007d-32"></a>This file defines C preprocessor macros which C code can use to adjust
its behaviour on different systems.  The <samp><span class="file">config.status</span></samp> script
will transform <samp><span class="file">config.in</span></samp> into <samp><span class="file">config.h</span></samp>.

     <br><dt><samp><span class="file">config.cache</span></samp><dd><a name="index-g_t_0040file_007bconfig_002ecache_007d-33"></a>This file did not fit neatly into the picture, and I omitted it.  It is
used by the <samp><span class="file">configure</span></samp> script to cache results between runs.  This
can be an important speedup.  If you modify <samp><span class="file">configure.in</span></samp> in such
a way that the results of old tests should change (perhaps you have
added a new library to &lsquo;<samp><span class="samp">LDFLAGS</span></samp>&rsquo;), then you will have to remove
<samp><span class="file">config.cache</span></samp> to force the tests to be rerun.

     <p>The autoconf manual explains how to set up a site specific cache file. 
This can speed up running <samp><span class="file">configure</span></samp> scripts on your system.

     <br><dt><samp><span class="file">stamp.h</span></samp><dd><a name="index-g_t_0040file_007bstamp_002dh_007d-34"></a>This file, which I omitted from the picture, is similar to
<samp><span class="file">stamp-h.in</span></samp>.  It is used as a timestamp file indicating whether
<samp><span class="file">config.h</span></samp> is up to date.  This is useful since <samp><span class="file">config.h</span></samp>
depends upon <samp><span class="file">config.status</span></samp>, but it is easy for
<samp><span class="file">config.status</span></samp> to change in a way which does not affect
<samp><span class="file">config.h</span></samp>. 
</dl>

<div class="node">
<a name="Support-Files"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Build-Files">Build Files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Files">Files</a>

</div>

<h3 class="section">3.3 Support Files</h3>

<p>The GNU configure and build system requires several support files to be
included with your distribution.  You do not normally need to concern
yourself with these.  If you are using the Cygnus tree, most are already
present.  Otherwise, they will be installed with your source by
&lsquo;<samp><span class="samp">automake</span></samp>&rsquo; (with the &lsquo;<samp><span class="samp">--add-missing</span></samp>&rsquo; option) and
&lsquo;<samp><span class="samp">libtoolize</span></samp>&rsquo;.

   <p>You don't have to put the support files in the top level directory.  You
can put them in a subdirectory, and use the &lsquo;<samp><span class="samp">AC_CONFIG_AUX_DIR</span></samp>&rsquo;
macro in <samp><span class="file">configure.in</span></samp> to tell &lsquo;<samp><span class="samp">automake</span></samp>&rsquo; and the
<samp><span class="file">configure</span></samp> script where they are.

   <p>In this section, I describe the support files, so that you can know what
they are and why they are there.

     <dl>
<dt><samp><span class="file">ABOUT-NLS</span></samp><dd>Added by automake if you are using gettext.  This is a documentation
file about the gettext project. 
<br><dt><samp><span class="file">ansi2knr.c</span></samp><dd>Used by an automake generated <samp><span class="file">Makefile</span></samp> if you put &lsquo;<samp><span class="samp">ansi2knr</span></samp>&rsquo;
in &lsquo;<samp><span class="samp">AUTOMAKE_OPTIONS</span></samp>&rsquo; in <samp><span class="file">Makefile.am</span></samp>.  This permits
compiling ANSI C code with a K&amp;R C compiler. 
<br><dt><samp><span class="file">ansi2knr.1</span></samp><dd>The man page which goes with <samp><span class="file">ansi2knr.c</span></samp>. 
<br><dt><samp><span class="file">config.guess</span></samp><dd>A shell script which determines the configuration name for the system on
which it is run. 
<br><dt><samp><span class="file">config.sub</span></samp><dd>A shell script which canonicalizes a configuration name entered by a
user. 
<br><dt><samp><span class="file">elisp-comp</span></samp><dd>Used to compile Emacs LISP files. 
<br><dt><samp><span class="file">install-sh</span></samp><dd>A shell script which installs a program.  This is used if the configure
script can not find an install binary. 
<br><dt><samp><span class="file">ltconfig</span></samp><dd>Used by libtool.  This is a shell script which configures libtool for
the particular system on which it is used. 
<br><dt><samp><span class="file">ltmain.sh</span></samp><dd>Used by libtool.  This is the actual libtool script which is used, after
it is configured by <samp><span class="file">ltconfig</span></samp> to build a library. 
<br><dt><samp><span class="file">mdate-sh</span></samp><dd>A shell script used by an automake generated <samp><span class="file">Makefile</span></samp> to pretty
print the modification time of a file.  This is used to maintain version
numbers for texinfo files. 
<br><dt><samp><span class="file">missing</span></samp><dd>A shell script used if some tool is missing entirely.  This is used by
an automake generated <samp><span class="file">Makefile</span></samp> to avoid certain sorts of
timestamp problems. 
<br><dt><samp><span class="file">mkinstalldirs</span></samp><dd>A shell script which creates a directory, including all parent
directories.  This is used by an automake generated <samp><span class="file">Makefile</span></samp>
during installation. 
<br><dt><samp><span class="file">texinfo.tex</span></samp><dd>Required if you have any texinfo files.  This is used when converting
Texinfo files into DVI using &lsquo;<samp><span class="samp">texi2dvi</span></samp>&rsquo; and TeX. 
<br><dt><samp><span class="file">ylwrap</span></samp><dd>A shell script used by an automake generated <samp><span class="file">Makefile</span></samp> to run
programs like &lsquo;<samp><span class="samp">bison</span></samp>&rsquo;, &lsquo;<samp><span class="samp">yacc</span></samp>&rsquo;, &lsquo;<samp><span class="samp">flex</span></samp>&rsquo;, and &lsquo;<samp><span class="samp">lex</span></samp>&rsquo;. 
These programs default to producing output files with a fixed name, and
the <samp><span class="file">ylwrap</span></samp> script runs them in a subdirectory to avoid file name
conflicts when using a parallel make program. 
</dl>

<div class="node">
<a name="Configuration-Names"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Cross-Compilation-Tools">Cross Compilation Tools</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Files">Files</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">4 Configuration Names</h2>

<p><a name="index-configuration-names-35"></a><a name="index-configuration-triplets-36"></a><a name="index-triplets-37"></a><a name="index-host-names-38"></a><a name="index-host-triplets-39"></a><a name="index-canonical-system-names-40"></a><a name="index-system-names-41"></a><a name="index-system-types-42"></a>
The GNU configure system names all systems using a <dfn>configuration
name</dfn>.  All such names used to be triplets (they may now contain four
parts in certain cases), and the term <dfn>configuration triplet</dfn> is
still seen.

<ul class="menu">
<li><a accesskey="1" href="#Configuration-Name-Definition">Configuration Name Definition</a>: 	Configuration Name Definition. 
<li><a accesskey="2" href="#Using-Configuration-Names">Using Configuration Names</a>: 		Using Configuration Names. 
</ul>

<div class="node">
<a name="Configuration-Name-Definition"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Using-Configuration-Names">Using Configuration Names</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Configuration-Names">Configuration Names</a>

</div>

<h3 class="section">4.1 Configuration Name Definition</h3>

<p>This is a string of the form
<var>cpu</var>-<var>manufacturer</var>-<var>operating_system</var>.  In some cases,
this is extended to a four part form:
<var>cpu</var>-<var>manufacturer</var>-<var>kernel</var>-<var>operating_system</var>.

   <p>When using a configuration name in a configure option, it is normally
not necessary to specify an entire name.  In particular, the
<var>manufacturer</var> field is often omitted, leading to strings such as
&lsquo;<samp><span class="samp">i386-linux</span></samp>&rsquo; or &lsquo;<samp><span class="samp">sparc-sunos</span></samp>&rsquo;.  The shell script
<samp><span class="file">config.sub</span></samp> will translate these shortened strings into the
canonical form.  autoconf will arrange for <samp><span class="file">config.sub</span></samp> to be run
automatically when it is needed.

   <p>The fields of a configuration name are as follows:

     <dl>
<dt><var>cpu</var><dd>The type of processor.  This is typically something like &lsquo;<samp><span class="samp">i386</span></samp>&rsquo; or
&lsquo;<samp><span class="samp">sparc</span></samp>&rsquo;.  More specific variants are used as well, such as
&lsquo;<samp><span class="samp">mipsel</span></samp>&rsquo; to indicate a little endian MIPS processor. 
<br><dt><var>manufacturer</var><dd>A somewhat freeform field which indicates the manufacturer of the
system.  This is often simply &lsquo;<samp><span class="samp">unknown</span></samp>&rsquo;.  Other common strings are
&lsquo;<samp><span class="samp">pc</span></samp>&rsquo; for an IBM PC compatible system, or the name of a workstation
vendor, such as &lsquo;<samp><span class="samp">sun</span></samp>&rsquo;. 
<br><dt><var>operating_system</var><dd>The name of the operating system which is run on the system.  This will
be something like &lsquo;<samp><span class="samp">solaris2.5</span></samp>&rsquo; or &lsquo;<samp><span class="samp">irix6.3</span></samp>&rsquo;.  There is no
particular restriction on the version number, and strings like
&lsquo;<samp><span class="samp">aix4.1.4.0</span></samp>&rsquo; are seen.  For an embedded system, which has no
operating system, this field normally indicates the type of object file
format, such as &lsquo;<samp><span class="samp">elf</span></samp>&rsquo; or &lsquo;<samp><span class="samp">coff</span></samp>&rsquo;. 
<br><dt><var>kernel</var><dd>This is used mainly for GNU/Linux.  A typical GNU/Linux configuration
name is &lsquo;<samp><span class="samp">i586-pc-linux-gnulibc1</span></samp>&rsquo;.  In this case the kernel,
&lsquo;<samp><span class="samp">linux</span></samp>&rsquo;, is separated from the operating system, &lsquo;<samp><span class="samp">gnulibc1</span></samp>&rsquo;. 
</dl>

   <p>The shell script <samp><span class="file">config.guess</span></samp> will normally print the correct
configuration name for the system on which it is run.  It does by
running &lsquo;<samp><span class="samp">uname</span></samp>&rsquo; and by examining other characteristics of the
system.

   <p>Because <samp><span class="file">config.guess</span></samp> can normally determine the configuration
name for a machine, it is normally only necessary to specify a
configuration name when building a cross-compiler or when building using
a cross-compiler.

<div class="node">
<a name="Using-Configuration-Names"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Configuration-Name-Definition">Configuration Name Definition</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Configuration-Names">Configuration Names</a>

</div>

<h3 class="section">4.2 Using Configuration Names</h3>

<p>A configure script will sometimes have to make a decision based on a
configuration name.  You will need to do this if you have to compile
code differently based on something which can not be tested using a
standard autoconf feature test.

   <p>It is normally better to test for particular features, rather than to
test for a particular system.  This is because as Unix evolves,
different systems copy features from one another.  Even if you need to
determine whether the feature is supported based on a configuration
name, you should define a macro which describes the feature, rather than
defining a macro which describes the particular system you are on.

   <p>Testing for a particular system is normally done using a case statement
in <samp><span class="file">configure.in</span></samp>.  The case statement might look something like
the following, assuming that &lsquo;<samp><span class="samp">host</span></samp>&rsquo; is a shell variable holding a
canonical configuration name (which will be the case if
<samp><span class="file">configure.in</span></samp> uses the &lsquo;<samp><span class="samp">AC_CANONICAL_HOST</span></samp>&rsquo; or
&lsquo;<samp><span class="samp">AC_CANONICAL_SYSTEM</span></samp>&rsquo; macro).

<pre class="smallexample">     case "${host}" in
     i[3-7]86-*-linux-gnu*) do something ;;
     sparc*-sun-solaris2.[56789]*) do something ;;
     sparc*-sun-solaris*) do something ;;
     mips*-*-elf*) do something ;;
     esac
</pre>
   <p>It is particularly important to use &lsquo;<samp><span class="samp">*</span></samp>&rsquo; after the operating system
field, in order to match the version number which will be generated by
<samp><span class="file">config.guess</span></samp>.

   <p>In most cases you must be careful to match a range of processor types. 
For most processor families, a trailing &lsquo;<samp><span class="samp">*</span></samp>&rsquo; suffices, as in
&lsquo;<samp><span class="samp">mips*</span></samp>&rsquo; above.  For the i386 family, something along the lines of
&lsquo;<samp><span class="samp">i[3-7]86</span></samp>&rsquo; suffices at present.  For the m68k family, you will
need something like &lsquo;<samp><span class="samp">m68*</span></samp>&rsquo;.  Of course, if you do not need to match
on the processor, it is simpler to just replace the entire field by a
&lsquo;<samp><span class="samp">*</span></samp>&rsquo;, as in &lsquo;<samp><span class="samp">*-*-irix*</span></samp>&rsquo;.

<div class="node">
<a name="Cross-Compilation-Tools"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Canadian-Cross">Canadian Cross</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Configuration-Names">Configuration Names</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">5 Cross Compilation Tools</h2>

<p><a name="index-cross-tools-43"></a>
The GNU configure and build system can be used to build <dfn>cross
compilation</dfn> tools.  A cross compilation tool is a tool which runs on
one system and produces code which runs on another system.

<ul class="menu">
<li><a accesskey="1" href="#Cross-Compilation-Concepts">Cross Compilation Concepts</a>: 		Cross Compilation Concepts. 
<li><a accesskey="2" href="#Host-and-Target">Host and Target</a>: 			Host and Target. 
<li><a accesskey="3" href="#Using-the-Host-Type">Using the Host Type</a>: 			Using the Host Type. 
<li><a accesskey="4" href="#Specifying-the-Target">Specifying the Target</a>:        	Specifying the Target. 
<li><a accesskey="5" href="#Using-the-Target-Type">Using the Target Type</a>: 		Using the Target Type. 
<li><a accesskey="6" href="#Cross-Tools-in-the-Cygnus-Tree">Cross Tools in the Cygnus Tree</a>: 	Cross Tools in the Cygnus Tree
</ul>

<div class="node">
<a name="Cross-Compilation-Concepts"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Host-and-Target">Host and Target</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Cross-Compilation-Tools">Cross Compilation Tools</a>

</div>

<h3 class="section">5.1 Cross Compilation Concepts</h3>

<p><a name="index-cross-compiler-44"></a>A compiler which produces programs which run on a different system is a
cross compilation compiler, or simply a <dfn>cross compiler</dfn>. 
Similarly, we speak of cross assemblers, cross linkers, etc.

   <p>In the normal case, a compiler produces code which runs on the same
system as the one on which the compiler runs.  When it is necessary to
distinguish this case from the cross compilation case, such a compiler
is called a <dfn>native compiler</dfn>.  Similarly, we speak of native
assemblers, etc.

   <p>Although the debugger is not strictly speaking a compilation tool, it is
nevertheless meaningful to speak of a cross debugger: a debugger which
is used to debug code which runs on another system.  Everything that is
said below about configuring cross compilation tools applies to the
debugger as well.

<div class="node">
<a name="Host-and-Target"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Using-the-Host-Type">Using the Host Type</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Cross-Compilation-Concepts">Cross Compilation Concepts</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Cross-Compilation-Tools">Cross Compilation Tools</a>

</div>

<h3 class="section">5.2 Host and Target</h3>

<p><a name="index-host-system-45"></a><a name="index-target-system-46"></a>
When building cross compilation tools, there are two different systems
involved: the system on which the tools will run, and the system for
which the tools generate code.

   <p>The system on which the tools will run is called the <dfn>host</dfn> system.

   <p>The system for which the tools generate code is called the <dfn>target</dfn>
system.

   <p>For example, suppose you have a compiler which runs on a GNU/Linux
system and generates ELF programs for a MIPS embedded system.  In this
case the GNU/Linux system is the host, and the MIPS ELF system is the
target.  Such a compiler could be called a GNU/Linux cross MIPS ELF
compiler, or, equivalently, a &lsquo;<samp><span class="samp">i386-linux-gnu</span></samp>&rsquo; cross
&lsquo;<samp><span class="samp">mips-elf</span></samp>&rsquo; compiler.

   <p>Naturally, most programs are not cross compilation tools.  For those
programs, it does not make sense to speak of a target.  It only makes
sense to speak of a target for tools like &lsquo;<samp><span class="samp">gcc</span></samp>&rsquo; or the
&lsquo;<samp><span class="samp">binutils</span></samp>&rsquo; which actually produce running code.  For example, it
does not make sense to speak of the target of a tool like &lsquo;<samp><span class="samp">bison</span></samp>&rsquo;
or &lsquo;<samp><span class="samp">make</span></samp>&rsquo;.

   <p>Most cross compilation tools can also serve as native tools.  For a
native compilation tool, it is still meaningful to speak of a target. 
For a native tool, the target is the same as the host.  For example, for
a GNU/Linux native compiler, the host is GNU/Linux, and the target is
also GNU/Linux.

<div class="node">
<a name="Using-the-Host-Type"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Specifying-the-Target">Specifying the Target</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Host-and-Target">Host and Target</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Cross-Compilation-Tools">Cross Compilation Tools</a>

</div>

<h3 class="section">5.3 Using the Host Type</h3>

<p>In almost all cases the host system is the system on which you run the
&lsquo;<samp><span class="samp">configure</span></samp>&rsquo; script, and on which you build the tools (for the case
when they differ, see <a href="#Canadian-Cross">Canadian Cross</a>).

   <p><a name="index-g_t_0040samp_007bAC_005fCANONICAL_005fHOST_007d-47"></a>If your configure script needs to know the configuration name of the
host system, and the package is not a cross compilation tool and
therefore does not have a target, put &lsquo;<samp><span class="samp">AC_CANONICAL_HOST</span></samp>&rsquo; in
<samp><span class="file">configure.in</span></samp>.  This macro will arrange to define a few shell
variables when the &lsquo;<samp><span class="samp">configure</span></samp>&rsquo; script is run.

     <dl>
<dt>&lsquo;<samp><span class="samp">host</span></samp>&rsquo;<dd>The canonical configuration name of the host.  This will normally be
determined by running the <samp><span class="file">config.guess</span></samp> shell script, although the
user is permitted to override this by using an explicit &lsquo;<samp><span class="samp">--host</span></samp>&rsquo;
option. 
<br><dt>&lsquo;<samp><span class="samp">host_alias</span></samp>&rsquo;<dd>In the unusual case that the user used an explicit &lsquo;<samp><span class="samp">--host</span></samp>&rsquo; option,
this will be the argument to &lsquo;<samp><span class="samp">--host</span></samp>&rsquo;.  In the normal case, this
will be the same as the &lsquo;<samp><span class="samp">host</span></samp>&rsquo; variable. 
<br><dt>&lsquo;<samp><span class="samp">host_cpu</span></samp>&rsquo;<dt>&lsquo;<samp><span class="samp">host_vendor</span></samp>&rsquo;<dt>&lsquo;<samp><span class="samp">host_os</span></samp>&rsquo;<dd>The first three parts of the canonical configuration name. 
</dl>

   <p>The shell variables may be used by putting shell code in
<samp><span class="file">configure.in</span></samp>.  For an example, see <a href="#Using-Configuration-Names">Using Configuration Names</a>.

<div class="node">
<a name="Specifying-the-Target"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Using-the-Target-Type">Using the Target Type</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Using-the-Host-Type">Using the Host Type</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Cross-Compilation-Tools">Cross Compilation Tools</a>

</div>

<h3 class="section">5.4 Specifying the Target</h3>

<p>By default, the &lsquo;<samp><span class="samp">configure</span></samp>&rsquo; script will assume that the target is
the same as the host.  This is the more common case; for example, it
leads to a native compiler rather than a cross compiler.

   <p><a name="index-g_t_0040samp_007b_002d_002dtarget_007d-option-48"></a><a name="index-target-option-49"></a><a name="index-configure-target-50"></a>If you want to build a cross compilation tool, you must specify the
target explicitly by using the &lsquo;<samp><span class="samp">--target</span></samp>&rsquo; option when you run
&lsquo;<samp><span class="samp">configure</span></samp>&rsquo;.  The argument to &lsquo;<samp><span class="samp">--target</span></samp>&rsquo; is the configuration
name of the system for which you wish to generate code. 
See <a href="#Configuration-Names">Configuration Names</a>.

   <p>For example, to build tools which generate code for a MIPS ELF embedded
system, you would use &lsquo;<samp><span class="samp">--target mips-elf</span></samp>&rsquo;.

<div class="node">
<a name="Using-the-Target-Type"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Cross-Tools-in-the-Cygnus-Tree">Cross Tools in the Cygnus Tree</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Specifying-the-Target">Specifying the Target</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Cross-Compilation-Tools">Cross Compilation Tools</a>

</div>

<h3 class="section">5.5 Using the Target Type</h3>

<p><a name="index-g_t_0040samp_007bAC_005fCANONICAL_005fSYSTEM_007d-51"></a>When writing <samp><span class="file">configure.in</span></samp> for a cross compilation tool, you will
need to use information about the target.  To do this, put
&lsquo;<samp><span class="samp">AC_CANONICAL_SYSTEM</span></samp>&rsquo; in <samp><span class="file">configure.in</span></samp>.

   <p>&lsquo;<samp><span class="samp">AC_CANONICAL_SYSTEM</span></samp>&rsquo; will look for a &lsquo;<samp><span class="samp">--target</span></samp>&rsquo; option and
canonicalize it using the <samp><span class="file">config.sub</span></samp> shell script.  It will also
run &lsquo;<samp><span class="samp">AC_CANONICAL_HOST</span></samp>&rsquo; (see <a href="#Using-the-Host-Type">Using the Host Type</a>).

   <p>The target type will be recorded in the following shell variables.  Note
that the host versions of these variables will also be defined by
&lsquo;<samp><span class="samp">AC_CANONICAL_HOST</span></samp>&rsquo;.

     <dl>
<dt>&lsquo;<samp><span class="samp">target</span></samp>&rsquo;<dd>The canonical configuration name of the target. 
<br><dt>&lsquo;<samp><span class="samp">target_alias</span></samp>&rsquo;<dd>The argument to the &lsquo;<samp><span class="samp">--target</span></samp>&rsquo; option.  If the user did not specify
a &lsquo;<samp><span class="samp">--target</span></samp>&rsquo; option, this will be the same as &lsquo;<samp><span class="samp">host_alias</span></samp>&rsquo;. 
<br><dt>&lsquo;<samp><span class="samp">target_cpu</span></samp>&rsquo;<dt>&lsquo;<samp><span class="samp">target_vendor</span></samp>&rsquo;<dt>&lsquo;<samp><span class="samp">target_os</span></samp>&rsquo;<dd>The first three parts of the canonical target configuration name. 
</dl>

   <p>Note that if &lsquo;<samp><span class="samp">host</span></samp>&rsquo; and &lsquo;<samp><span class="samp">target</span></samp>&rsquo; are the same string, you can
assume a native configuration.  If they are different, you can assume a
cross configuration.

   <p>It is arguably possible for &lsquo;<samp><span class="samp">host</span></samp>&rsquo; and &lsquo;<samp><span class="samp">target</span></samp>&rsquo; to represent
the same system, but for the strings to not be identical.  For example,
if &lsquo;<samp><span class="samp">config.guess</span></samp>&rsquo; returns &lsquo;<samp><span class="samp">sparc-sun-sunos4.1.4</span></samp>&rsquo;, and somebody
configures with &lsquo;<samp><span class="samp">--target sparc-sun-sunos4.1</span></samp>&rsquo;, then the slight
differences between the two versions of SunOS may be unimportant for
your tool.  However, in the general case it can be quite difficult to
determine whether the differences between two configuration names are
significant or not.  Therefore, by convention, if the user specifies a
&lsquo;<samp><span class="samp">--target</span></samp>&rsquo; option without specifying a &lsquo;<samp><span class="samp">--host</span></samp>&rsquo; option, it is
assumed that the user wants to configure a cross compilation tool.

   <p>The variables &lsquo;<samp><span class="samp">target</span></samp>&rsquo; and &lsquo;<samp><span class="samp">target_alias</span></samp>&rsquo; should be handled
differently.

   <p>In general, whenever the user may actually see a string,
&lsquo;<samp><span class="samp">target_alias</span></samp>&rsquo; should be used.  This includes anything which may
appear in the file system, such as a directory name or part of a tool
name.  It also includes any tool output, unless it is clearly labelled
as the canonical target configuration name.  This permits the user to
use the &lsquo;<samp><span class="samp">--target</span></samp>&rsquo; option to specify how the tool will appear to
the outside world.

   <p>On the other hand, when checking for characteristics of the target
system, &lsquo;<samp><span class="samp">target</span></samp>&rsquo; should be used.  This is because a wide variety of
&lsquo;<samp><span class="samp">--target</span></samp>&rsquo; options may map into the same canonical configuration
name.  You should not attempt to duplicate the canonicalization done by
&lsquo;<samp><span class="samp">config.sub</span></samp>&rsquo; in your own code.

   <p>By convention, cross tools are installed with a prefix of the argument
used with the &lsquo;<samp><span class="samp">--target</span></samp>&rsquo; option, also known as &lsquo;<samp><span class="samp">target_alias</span></samp>&rsquo;
(see <a href="#Using-the-Target-Type">Using the Target Type</a>).  If the user does not use the
&lsquo;<samp><span class="samp">--target</span></samp>&rsquo; option, and thus is building a native tool, no prefix is
used.

   <p>For example, if gcc is configured with &lsquo;<samp><span class="samp">--target mips-elf</span></samp>&rsquo;, then
the installed binary will be named &lsquo;<samp><span class="samp">mips-elf-gcc</span></samp>&rsquo;.  If gcc is
configured without a &lsquo;<samp><span class="samp">--target</span></samp>&rsquo; option, then the installed binary
will be named &lsquo;<samp><span class="samp">gcc</span></samp>&rsquo;.

   <p>The autoconf macro &lsquo;<samp><span class="samp">AC_ARG_PROGRAM</span></samp>&rsquo; will handle this for you.  If
you are using automake, no more need be done; the programs will
automatically be installed with the correct prefixes.  Otherwise, see
the autoconf documentation for &lsquo;<samp><span class="samp">AC_ARG_PROGRAM</span></samp>&rsquo;.

<div class="node">
<a name="Cross-Tools-in-the-Cygnus-Tree"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Using-the-Target-Type">Using the Target Type</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Cross-Compilation-Tools">Cross Compilation Tools</a>

</div>

<h3 class="section">5.6 Cross Tools in the Cygnus Tree</h3>

<p>The Cygnus tree is used for various packages including gdb, the GNU
binutils, and egcs.  It is also, of course, used for Cygnus releases.

   <p>In the Cygnus tree, the top level <samp><span class="file">configure</span></samp> script uses the old
Cygnus configure system, not autoconf.  The top level <samp><span class="file">Makefile.in</span></samp>
is written to build packages based on what is in the source tree, and
supports building a large number of tools in a single
&lsquo;<samp><span class="samp">configure</span></samp>&rsquo;/&lsquo;<samp><span class="samp">make</span></samp>&rsquo; step.

   <p>The Cygnus tree may be configured with a &lsquo;<samp><span class="samp">--target</span></samp>&rsquo; option.  The
&lsquo;<samp><span class="samp">--target</span></samp>&rsquo; option applies recursively to every subdirectory, and
permits building an entire set of cross tools at once.

<ul class="menu">
<li><a accesskey="1" href="#Host-and-Target-Libraries">Host and Target Libraries</a>: 		Host and Target Libraries. 
<li><a accesskey="2" href="#Target-Library-Configure-Scripts">Target Library Configure Scripts</a>: 	Target Library Configure Scripts. 
<li><a accesskey="3" href="#Make-Targets-in-Cygnus-Tree">Make Targets in Cygnus Tree</a>:          Make Targets in Cygnus Tree. 
<li><a accesskey="4" href="#Target-libiberty">Target libiberty</a>: 			Target libiberty
</ul>

<div class="node">
<a name="Host-and-Target-Libraries"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Target-Library-Configure-Scripts">Target Library Configure Scripts</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Cross-Tools-in-the-Cygnus-Tree">Cross Tools in the Cygnus Tree</a>

</div>

<h4 class="subsection">5.6.1 Host and Target Libraries</h4>

<p>The Cygnus tree distinguishes host libraries from target libraries.

   <p>Host libraries are built with the compiler used to build the programs
which run on the host, which is called the host compiler.  This includes
libraries such as &lsquo;<samp><span class="samp">bfd</span></samp>&rsquo; and &lsquo;<samp><span class="samp">tcl</span></samp>&rsquo;.  These libraries are built
with the host compiler, and are linked into programs like the binutils
or gcc which run on the host.

   <p>Target libraries are built with the target compiler.  If gcc is present
in the source tree, then the target compiler is the gcc that is built
using the host compiler.  Target libraries are libraries such as
&lsquo;<samp><span class="samp">newlib</span></samp>&rsquo; and &lsquo;<samp><span class="samp">libstdc++</span></samp>&rsquo;.  These libraries are not linked into
the host programs, but are instead made available for use with programs
built with the target compiler.

   <p>For the rest of this section, assume that gcc is present in the source
tree, so that it will be used to build the target libraries.

   <p>There is a complication here.  The configure process needs to know which
compiler you are going to use to build a tool; otherwise, the feature
tests will not work correctly.  The Cygnus tree handles this by not
configuring the target libraries until the target compiler is built.  In
order to permit everything to build using a single
&lsquo;<samp><span class="samp">configure</span></samp>&rsquo;/&lsquo;<samp><span class="samp">make</span></samp>&rsquo;, the configuration of the target libraries
is actually triggered during the make step.

   <p>When the target libraries are configured, the &lsquo;<samp><span class="samp">--target</span></samp>&rsquo; option is
not used.  Instead, the &lsquo;<samp><span class="samp">--host</span></samp>&rsquo; option is used with the argument
of the &lsquo;<samp><span class="samp">--target</span></samp>&rsquo; option for the overall configuration.  If no
&lsquo;<samp><span class="samp">--target</span></samp>&rsquo; option was used for the overall configuration, the
&lsquo;<samp><span class="samp">--host</span></samp>&rsquo; option will be passed with the output of the
<samp><span class="file">config.guess</span></samp> shell script.  Any &lsquo;<samp><span class="samp">--build</span></samp>&rsquo; option is passed
down unchanged.

   <p>This translation of configuration options is done because since the
target libraries are compiled with the target compiler, they are being
built in order to run on the target of the overall configuration.  By
the definition of host, this means that their host system is the same as
the target system of the overall configuration.

   <p>The same process is used for both a native configuration and a cross
configuration.  Even when using a native configuration, the target
libraries will be configured and built using the newly built compiler. 
This is particularly important for the C++ libraries, since there is no
reason to assume that the C++ compiler used to build the host tools (if
there even is one) uses the same ABI as the g++ compiler which will be
used to build the target libraries.

   <p>There is one difference between a native configuration and a cross
configuration.  In a native configuration, the target libraries are
normally configured and built as siblings of the host tools.  In a cross
configuration, the target libraries are normally built in a subdirectory
whose name is the argument to &lsquo;<samp><span class="samp">--target</span></samp>&rsquo;.  This is mainly for
historical reasons.

   <p>To summarize, running &lsquo;<samp><span class="samp">configure</span></samp>&rsquo; in the Cygnus tree configures all
the host libraries and tools, but does not configure any of the target
libraries.  Running &lsquo;<samp><span class="samp">make</span></samp>&rsquo; then does the following steps:

     <ul>
<li>Build the host libraries. 
<li>Build the host programs, including gcc.  Note that we call gcc both a
host program (since it runs on the host) and a target compiler (since it
generates code for the target). 
<li>Using the newly built target compiler, configure the target libraries. 
<li>Build the target libraries. 
</ul>

   <p>The steps need not be done in precisely this order, since they are
actually controlled by <samp><span class="file">Makefile</span></samp> targets.

<div class="node">
<a name="Target-Library-Configure-Scripts"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Make-Targets-in-Cygnus-Tree">Make Targets in Cygnus Tree</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Host-and-Target-Libraries">Host and Target Libraries</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Cross-Tools-in-the-Cygnus-Tree">Cross Tools in the Cygnus Tree</a>

</div>

<h4 class="subsection">5.6.2 Target Library Configure Scripts</h4>

<p>There are a few things you must know in order to write a configure
script for a target library.  This is just a quick sketch, and beginners
shouldn't worry if they don't follow everything here.

   <p>The target libraries are configured and built using a newly built target
compiler.  There may not be any startup files or libraries for this
target compiler.  In fact, those files will probably be built as part of
some target library, which naturally means that they will not exist when
your target library is configured.

   <p>This means that the configure script for a target library may not use
any test which requires doing a link.  This unfortunately includes many
useful autoconf macros, such as &lsquo;<samp><span class="samp">AC_CHECK_FUNCS</span></samp>&rsquo;.  autoconf macros
which do a compile but not a link, such as &lsquo;<samp><span class="samp">AC_CHECK_HEADERS</span></samp>&rsquo;, may
be used.

   <p>This is a severe restriction, but normally not a fatal one, as target
libraries can often assume the presence of other target libraries, and
thus know which functions will be available.

   <p>As of this writing, the autoconf macro &lsquo;<samp><span class="samp">AC_PROG_CC</span></samp>&rsquo; does a link to
make sure that the compiler works.  This may fail in a target library,
so target libraries must use a different set of macros to locate the
compiler.  See the <samp><span class="file">configure.in</span></samp> file in a directory like
<samp><span class="file">libiberty</span></samp> or <samp><span class="file">libgloss</span></samp> for an example.

   <p>As noted in the previous section, target libraries are sometimes built
in directories which are siblings to the host tools, and are sometimes
built in a subdirectory.  The &lsquo;<samp><span class="samp">--with-target-subdir</span></samp>&rsquo; configure
option will be passed when the library is configured.  Its value will be
an empty string if the target library is a sibling.  Its value will be
the name of the subdirectory if the target library is in a subdirectory.

   <p>If the overall build is not a native build (i.e., the overall configure
used the &lsquo;<samp><span class="samp">--target</span></samp>&rsquo; option), then the library will be configured
with the &lsquo;<samp><span class="samp">--with-cross-host</span></samp>&rsquo; option.  The value of this option will
be the host system of the overall build.  Recall that the host system of
the library will be the target of the overall build.  If the overall
build is a native build, the &lsquo;<samp><span class="samp">--with-cross-host</span></samp>&rsquo; option will not be
used.

   <p>A library which can be built both standalone and as a target library may
want to install itself into different directories depending upon the
case.  When built standalone, or when built native, the library should
be installed in &lsquo;<samp><span class="samp">$(libdir)</span></samp>&rsquo;.  When built as a target library which
is not native, the library should be installed in &lsquo;<samp><span class="samp">$(tooldir)/lib</span></samp>&rsquo;. 
The &lsquo;<samp><span class="samp">--with-cross-host</span></samp>&rsquo; option may be used to distinguish these
cases.

   <p>This same test of &lsquo;<samp><span class="samp">--with-cross-host</span></samp>&rsquo; may be used to see whether it
is OK to use link tests in the configure script.  If the
&lsquo;<samp><span class="samp">--with-cross-host</span></samp>&rsquo; option is not used, then the library is being
built either standalone or native, and a link should work.

<div class="node">
<a name="Make-Targets-in-Cygnus-Tree"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Target-libiberty">Target libiberty</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Target-Library-Configure-Scripts">Target Library Configure Scripts</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Cross-Tools-in-the-Cygnus-Tree">Cross Tools in the Cygnus Tree</a>

</div>

<h4 class="subsection">5.6.3 Make Targets in Cygnus Tree</h4>

<p>The top level <samp><span class="file">Makefile</span></samp> in the Cygnus tree defines targets for
every known subdirectory.

   <p>For every subdirectory <var>dir</var> which holds a host library or program,
the <samp><span class="file">Makefile</span></samp> target &lsquo;<samp><span class="samp">all-</span><var>dir</var></samp>&rsquo; will build that library
or program.

   <p>There are dependencies among host tools.  For example, building gcc
requires first building gas, because the gcc build process invokes the
target assembler.  These dependencies are reflected in the top level
<samp><span class="file">Makefile</span></samp>.

   <p>For every subdirectory <var>dir</var> which holds a target library, the
<samp><span class="file">Makefile</span></samp> target &lsquo;<samp><span class="samp">configure-target-</span><var>dir</var></samp>&rsquo; will configure
that library.  The <samp><span class="file">Makefile</span></samp> target &lsquo;<samp><span class="samp">all-target-</span><var>dir</var></samp>&rsquo;
will build that library.

   <p>Every &lsquo;<samp><span class="samp">configure-target-</span><var>dir</var></samp>&rsquo; target depends upon
&lsquo;<samp><span class="samp">all-gcc</span></samp>&rsquo;, since gcc, the target compiler, is required to configure
the tool.  Every &lsquo;<samp><span class="samp">all-target-</span><var>dir</var></samp>&rsquo; target depends upon the
corresponding &lsquo;<samp><span class="samp">configure-target-</span><var>dir</var></samp>&rsquo; target.

   <p>There are several other targets which may be of interest for each
directory: &lsquo;<samp><span class="samp">install-</span><var>dir</var></samp>&rsquo;, &lsquo;<samp><span class="samp">clean-</span><var>dir</var></samp>&rsquo;, and
&lsquo;<samp><span class="samp">check-</span><var>dir</var></samp>&rsquo;.  There are also corresponding &lsquo;<samp><span class="samp">target</span></samp>&rsquo;
versions of these for the target libraries , such as
&lsquo;<samp><span class="samp">install-target-</span><var>dir</var></samp>&rsquo;.

<div class="node">
<a name="Target-libiberty"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Make-Targets-in-Cygnus-Tree">Make Targets in Cygnus Tree</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Cross-Tools-in-the-Cygnus-Tree">Cross Tools in the Cygnus Tree</a>

</div>

<h4 class="subsection">5.6.4 Target libiberty</h4>

<p>The <samp><span class="file">libiberty</span></samp> subdirectory is currently a special case, in that
it is the only directory which is built both using the host compiler and
using the target compiler.

   <p>This is because the files in <samp><span class="file">libiberty</span></samp> are used when building the
host tools, and they are also incorporated into the <samp><span class="file">libstdc++</span></samp>
target library as support code.

   <p>This duality does not pose any particular difficulties.  It means that
there are targets for both &lsquo;<samp><span class="samp">all-libiberty</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">all-target-libiberty</span></samp>&rsquo;.

   <p>In a native configuration, when target libraries are not built in a
subdirectory, the same objects are normally used as both the host build
and the target build.  This is normally OK, since libiberty contains
only C code, and in a native configuration the results of the host
compiler and the target compiler are normally interoperable.

   <p>Irix 6 is again an exception here, since the SGI native compiler
defaults to using the &lsquo;<samp><span class="samp">O32</span></samp>&rsquo; ABI, and gcc defaults to using the
&lsquo;<samp><span class="samp">N32</span></samp>&rsquo; ABI.  On Irix 6, the target libraries are built in a
subdirectory even for a native configuration, avoiding this problem.

   <p>There are currently no other libraries built for both the host and the
target, but there is no conceptual problem with adding more.

<div class="node">
<a name="Canadian-Cross"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Cygnus-Configure">Cygnus Configure</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Cross-Compilation-Tools">Cross Compilation Tools</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">6 Canadian Cross</h2>

<p><a name="index-canadian-cross-52"></a><a name="index-building-with-a-cross-compiler-53"></a><a name="index-cross-compiler_002c-building-with-54"></a>
It is possible to use the GNU configure and build system to build a
program which will run on a system which is different from the system on
which the tools are built.  In other words, it is possible to build
programs using a cross compiler.

   <p>This is referred to as a <dfn>Canadian Cross</dfn>.

<ul class="menu">
<li><a accesskey="1" href="#Canadian-Cross-Example">Canadian Cross Example</a>: 		Canadian Cross Example. 
<li><a accesskey="2" href="#Canadian-Cross-Concepts">Canadian Cross Concepts</a>: 		Canadian Cross Concepts. 
<li><a accesskey="3" href="#Build-Cross-Host-Tools">Build Cross Host Tools</a>: 		Build Cross Host Tools. 
<li><a accesskey="4" href="#Build-and-Host-Options">Build and Host Options</a>: 		Build and Host Options. 
<li><a accesskey="5" href="#CCross-not-in-Cygnus-Tree">CCross not in Cygnus Tree</a>: 		Canadian Cross not in Cygnus Tree. 
<li><a accesskey="6" href="#CCross-in-Cygnus-Tree">CCross in Cygnus Tree</a>: 		Canadian Cross in Cygnus Tree. 
<li><a accesskey="7" href="#Supporting-Canadian-Cross">Supporting Canadian Cross</a>: 		Supporting Canadian Cross. 
</ul>

<div class="node">
<a name="Canadian-Cross-Example"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Canadian-Cross-Concepts">Canadian Cross Concepts</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Canadian-Cross">Canadian Cross</a>

</div>

<h3 class="section">6.1 Canadian Cross Example</h3>

<p>Here is an example of a Canadian Cross.

   <p>While running on a GNU/Linux, you can build a program which will run on
a Solaris system.  You would use a GNU/Linux cross Solaris compiler to
build the program.

   <p>Of course, you could not run the resulting program on your GNU/Linux
system.  You would have to copy it over to a Solaris system before you
would run it.

   <p>Of course, you could also simply build the programs on the Solaris
system in the first place.  However, perhaps the Solaris system is not
available for some reason; perhaps you actually don't have one, but you
want to build the tools for somebody else to use.  Or perhaps your
GNU/Linux system is much faster than your Solaris system.

   <p>A Canadian Cross build is most frequently used when building programs to
run on a non-Unix system, such as DOS or Windows.  It may be simpler to
configure and build on a Unix system than to support the configuration
machinery on a non-Unix system.

<div class="node">
<a name="Canadian-Cross-Concepts"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Build-Cross-Host-Tools">Build Cross Host Tools</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Canadian-Cross-Example">Canadian Cross Example</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Canadian-Cross">Canadian Cross</a>

</div>

<h3 class="section">6.2 Canadian Cross Concepts</h3>

<p>When building a Canadian Cross, there are at least two different systems
involved: the system on which the tools are being built, and the system
on which the tools will run.

   <p>The system on which the tools are being built is called the <dfn>build</dfn>
system.

   <p>The system on which the tools will run is called the host system.

   <p>For example, if you are building a Solaris program on a GNU/Linux
system, as in the previous section, the build system would be GNU/Linux,
and the host system would be Solaris.

   <p>It is, of course, possible to build a cross compiler using a Canadian
Cross (i.e., build a cross compiler using a cross compiler).  In this
case, the system for which the resulting cross compiler generates code
is called the target system.  (For a more complete discussion of host
and target systems, see <a href="#Host-and-Target">Host and Target</a>).

   <p>An example of building a cross compiler using a Canadian Cross would be
building a Windows cross MIPS ELF compiler on a GNU/Linux system.  In
this case the build system would be GNU/Linux, the host system would be
Windows, and the target system would be MIPS ELF.

   <p>The name Canadian Cross comes from the case when the build, host, and
target systems are all different.  At the time that these issues were
all being hashed out, Canada had three national political parties.

<div class="node">
<a name="Build-Cross-Host-Tools"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Build-and-Host-Options">Build and Host Options</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Canadian-Cross-Concepts">Canadian Cross Concepts</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Canadian-Cross">Canadian Cross</a>

</div>

<h3 class="section">6.3 Build Cross Host Tools</h3>

<p>In order to configure a program for a Canadian Cross build, you must
first build and install the set of cross tools you will use to build the
program.

   <p>These tools will be build cross host tools.  That is, they will run on
the build system, and will produce code that runs on the host system.

   <p>It is easy to confuse the meaning of build and host here.  Always
remember that the build system is where you are doing the build, and the
host system is where the resulting program will run.  Therefore, you
need a build cross host compiler.

   <p>In general, you must have a complete cross environment in order to do
the build.  This normally means a cross compiler, cross assembler, and
so forth, as well as libraries and include files for the host system.

<div class="node">
<a name="Build-and-Host-Options"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#CCross-not-in-Cygnus-Tree">CCross not in Cygnus Tree</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Build-Cross-Host-Tools">Build Cross Host Tools</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Canadian-Cross">Canadian Cross</a>

</div>

<h3 class="section">6.4 Build and Host Options</h3>

<p><a name="index-configuring-a-canadian-cross-55"></a><a name="index-canadian-cross_002c-configuring-56"></a>
When you run <samp><span class="file">configure</span></samp>, you must use both the &lsquo;<samp><span class="samp">--build</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">--host</span></samp>&rsquo; options.

   <p><a name="index-g_t_0040samp_007b_002d_002dbuild_007d-option-57"></a><a name="index-build-option-58"></a><a name="index-configure-build-system-59"></a>The &lsquo;<samp><span class="samp">--build</span></samp>&rsquo; option is used to specify the configuration name of
the build system.  This can normally be the result of running the
<samp><span class="file">config.guess</span></samp> shell script, and it is reasonable to use
&lsquo;<samp><span class="samp">--build=`config.guess`</span></samp>&rsquo;.

   <p><a name="index-g_t_0040samp_007b_002d_002dhost_007d-option-60"></a><a name="index-host-option-61"></a><a name="index-configure-host-62"></a>The &lsquo;<samp><span class="samp">--host</span></samp>&rsquo; option is used to specify the configuration name of
the host system.

   <p>As we explained earlier, <samp><span class="file">config.guess</span></samp> is used to set the default
value for the &lsquo;<samp><span class="samp">--host</span></samp>&rsquo; option (see <a href="#Using-the-Host-Type">Using the Host Type</a>).  We
can now see that since <samp><span class="file">config.guess</span></samp> returns the type of system on
which it is run, it really identifies the build system.  Since the host
system is normally the same as the build system (i.e., people do not
normally build using a cross compiler), it is reasonable to use the
result of <samp><span class="file">config.guess</span></samp> as the default for the host system when
the &lsquo;<samp><span class="samp">--host</span></samp>&rsquo; option is not used.

   <p>It might seem that if the &lsquo;<samp><span class="samp">--host</span></samp>&rsquo; option were used without the
&lsquo;<samp><span class="samp">--build</span></samp>&rsquo; option that the configure script could run
<samp><span class="file">config.guess</span></samp> to determine the build system, and presume a
Canadian Cross if the result of <samp><span class="file">config.guess</span></samp> differed from the
&lsquo;<samp><span class="samp">--host</span></samp>&rsquo; option.  However, for historical reasons, some configure
scripts are routinely run using an explicit &lsquo;<samp><span class="samp">--host</span></samp>&rsquo; option, rather
than using the default from <samp><span class="file">config.guess</span></samp>.  As noted earlier, it
is difficult or impossible to reliably compare configuration names
(see <a href="#Using-the-Target-Type">Using the Target Type</a>).  Therefore, by convention, if the
&lsquo;<samp><span class="samp">--host</span></samp>&rsquo; option is used, but the &lsquo;<samp><span class="samp">--build</span></samp>&rsquo; option is not used,
then the build system defaults to the host system.

<div class="node">
<a name="CCross-not-in-Cygnus-Tree"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#CCross-in-Cygnus-Tree">CCross in Cygnus Tree</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Build-and-Host-Options">Build and Host Options</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Canadian-Cross">Canadian Cross</a>

</div>

<h3 class="section">6.5 Canadian Cross not in Cygnus Tree.</h3>

<p>If you are not using the Cygnus tree, you must explicitly specify the
cross tools which you want to use to build the program.  This is done by
setting environment variables before running the <samp><span class="file">configure</span></samp>
script.

   <p>You must normally set at least the environment variables &lsquo;<samp><span class="samp">CC</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">AR</span></samp>&rsquo;, and &lsquo;<samp><span class="samp">RANLIB</span></samp>&rsquo; to the cross tools which you want to use to
build.

   <p>For some programs, you must set additional cross tools as well, such as
&lsquo;<samp><span class="samp">AS</span></samp>&rsquo;, &lsquo;<samp><span class="samp">LD</span></samp>&rsquo;, or &lsquo;<samp><span class="samp">NM</span></samp>&rsquo;.

   <p>You would set these environment variables to the build cross tools which
you are going to use.

   <p>For example, if you are building a Solaris program on a GNU/Linux
system, and your GNU/Linux cross Solaris compiler were named
&lsquo;<samp><span class="samp">solaris-gcc</span></samp>&rsquo;, then you would set the environment variable
&lsquo;<samp><span class="samp">CC</span></samp>&rsquo; to &lsquo;<samp><span class="samp">solaris-gcc</span></samp>&rsquo;.

<div class="node">
<a name="CCross-in-Cygnus-Tree"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Supporting-Canadian-Cross">Supporting Canadian Cross</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#CCross-not-in-Cygnus-Tree">CCross not in Cygnus Tree</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Canadian-Cross">Canadian Cross</a>

</div>

<h3 class="section">6.6 Canadian Cross in Cygnus Tree</h3>

<p><a name="index-canadian-cross-in-cygnus-tree-63"></a>
This section describes configuring and building a Canadian Cross when
using the Cygnus tree.

<ul class="menu">
<li><a accesskey="1" href="#Standard-Cygnus-CCross">Standard Cygnus CCross</a>: 	Building a Normal Program. 
<li><a accesskey="2" href="#Cross-Cygnus-CCross">Cross Cygnus CCross</a>: 		Building a Cross Program. 
</ul>

<div class="node">
<a name="Standard-Cygnus-CCross"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Cross-Cygnus-CCross">Cross Cygnus CCross</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#CCross-in-Cygnus-Tree">CCross in Cygnus Tree</a>

</div>

<h4 class="subsection">6.6.1 Building a Normal Program</h4>

<p>When configuring a Canadian Cross in the Cygnus tree, all the
appropriate environment variables are automatically set to
&lsquo;<samp><var>host</var><span class="samp">-</span><var>tool</var></samp>&rsquo;, where <var>host</var> is the value used for the
&lsquo;<samp><span class="samp">--host</span></samp>&rsquo; option, and <var>tool</var> is the name of the tool (e.g.,
&lsquo;<samp><span class="samp">gcc</span></samp>&rsquo;, &lsquo;<samp><span class="samp">as</span></samp>&rsquo;, etc.).  These tools must be on your &lsquo;<samp><span class="samp">PATH</span></samp>&rsquo;.

   <p>Adding a prefix of <var>host</var> will give the usual name for the build
cross host tools.  To see this, consider that when these cross tools
were built, they were configured to run on the build system and to
produce code for the host system.  That is, they were configured with a
&lsquo;<samp><span class="samp">--target</span></samp>&rsquo; option that is the same as the system which we are now
calling the host.  Recall that the default name for installed cross
tools uses the target system as a prefix (see <a href="#Using-the-Target-Type">Using the Target Type</a>).  Since that is the system which we are now calling the host,
<var>host</var> is the right prefix to use.

   <p>For example, if you configure with &lsquo;<samp><span class="samp">--build=i386-linux-gnu</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">--host=solaris</span></samp>&rsquo;, then the Cygnus tree will automatically default
to using the compiler &lsquo;<samp><span class="samp">solaris-gcc</span></samp>&rsquo;.  You must have previously
built and installed this compiler, probably by doing a build with no
&lsquo;<samp><span class="samp">--host</span></samp>&rsquo; option and with a &lsquo;<samp><span class="samp">--target</span></samp>&rsquo; option of
&lsquo;<samp><span class="samp">solaris</span></samp>&rsquo;.

<div class="node">
<a name="Cross-Cygnus-CCross"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Standard-Cygnus-CCross">Standard Cygnus CCross</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#CCross-in-Cygnus-Tree">CCross in Cygnus Tree</a>

</div>

<h4 class="subsection">6.6.2 Building a Cross Program</h4>

<p>There are additional considerations if you want to build a cross
compiler, rather than a native compiler, in the Cygnus tree using a
Canadian Cross.

   <p>When you build a cross compiler using the Cygnus tree, then the target
libraries will normally be built with the newly built target compiler
(see <a href="#Host-and-Target-Libraries">Host and Target Libraries</a>).  However, this will not work when
building with a Canadian Cross.  This is because the newly built target
compiler will be a program which runs on the host system, and therefore
will not be able to run on the build system.

   <p>Therefore, when building a cross compiler with the Cygnus tree, you must
first install a set of build cross target tools.  These tools will be
used when building the target libraries.

   <p>Note that this is not a requirement of a Canadian Cross in general.  For
example, it would be possible to build just the host cross target tools
on the build system, to copy the tools to the host system, and to build
the target libraries on the host system.  The requirement for build
cross target tools is imposed by the Cygnus tree, which expects to be
able to build both host programs and target libraries in a single
&lsquo;<samp><span class="samp">configure</span></samp>&rsquo;/&lsquo;<samp><span class="samp">make</span></samp>&rsquo; step.  Because it builds these in a single
step, it expects to be able to build the target libraries on the build
system, which means that it must use a build cross target toolchain.

   <p>For example, suppose you want to build a Windows cross MIPS ELF compiler
on a GNU/Linux system.  You must have previously installed both a
GNU/Linux cross Windows compiler and a GNU/Linux cross MIPS ELF
compiler.

   <p>In order to build the Windows (configuration name &lsquo;<samp><span class="samp">i386-cygwin32</span></samp>&rsquo;)
cross MIPS ELF (configure name &lsquo;<samp><span class="samp">mips-elf</span></samp>&rsquo;) compiler, you might
execute the following commands (long command lines are broken across
lines with a trailing backslash as a continuation character).

<pre class="example">     mkdir linux-x-cygwin32
     cd linux-x-cygwin32
     <var>srcdir</var>/configure --target i386-cygwin32 --prefix=<var>installdir</var> \
       --exec-prefix=<var>installdir</var>/H-i386-linux
     make
     make install
     cd ..
     mkdir linux-x-mips-elf
     cd linux-x-mips-elf
     <var>srcdir</var>/configure --target mips-elf --prefix=<var>installdir</var> \
       --exec-prefix=<var>installdir</var>/H-i386-linux
     make
     make install
     cd ..
     mkdir cygwin32-x-mips-elf
     cd cygwin32-x-mips-elf
     <var>srcdir</var>/configure --build=i386-linux-gnu --host=i386-cygwin32 \
       --target=mips-elf --prefix=<var>wininstalldir</var> \
       --exec-prefix=<var>wininstalldir</var>/H-i386-cygwin32
     make
     make install
</pre>
   <p>You would then copy the contents of <var>wininstalldir</var> over to the
Windows machine, and run the resulting programs.

<div class="node">
<a name="Supporting-Canadian-Cross"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#CCross-in-Cygnus-Tree">CCross in Cygnus Tree</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Canadian-Cross">Canadian Cross</a>

</div>

<h3 class="section">6.7 Supporting Canadian Cross</h3>

<p>If you want to make it possible to build a program you are developing
using a Canadian Cross, you must take some care when writing your
configure and make rules.  Simple cases will normally work correctly. 
However, it is not hard to write configure and make tests which will
fail in a Canadian Cross.

<ul class="menu">
<li><a accesskey="1" href="#CCross-in-Configure">CCross in Configure</a>: 		Supporting Canadian Cross in Configure Scripts. 
<li><a accesskey="2" href="#CCross-in-Make">CCross in Make</a>: 		Supporting Canadian Cross in Makefiles. 
</ul>

<div class="node">
<a name="CCross-in-Configure"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#CCross-in-Make">CCross in Make</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Supporting-Canadian-Cross">Supporting Canadian Cross</a>

</div>

<h4 class="subsection">6.7.1 Supporting Canadian Cross in Configure Scripts</h4>

<p><a name="index-canadian-cross-in-configure-64"></a>
In a <samp><span class="file">configure.in</span></samp> file, after calling &lsquo;<samp><span class="samp">AC_PROG_CC</span></samp>&rsquo;, you can
find out whether this is a Canadian Cross configure by examining the
shell variable &lsquo;<samp><span class="samp">cross_compiling</span></samp>&rsquo;.  In a Canadian Cross, which means
that the compiler is a cross compiler, &lsquo;<samp><span class="samp">cross_compiling</span></samp>&rsquo; will be
&lsquo;<samp><span class="samp">yes</span></samp>&rsquo;.  In a normal configuration, &lsquo;<samp><span class="samp">cross_compiling</span></samp>&rsquo; will be
&lsquo;<samp><span class="samp">no</span></samp>&rsquo;.

   <p>You ordinarily do not need to know the type of the build system in a
configure script.  However, if you do need that information, you can get
it by using the macro &lsquo;<samp><span class="samp">AC_CANONICAL_SYSTEM</span></samp>&rsquo;, the same macro that is
used to determine the target system.  This macro will set the variables
&lsquo;<samp><span class="samp">build</span></samp>&rsquo;, &lsquo;<samp><span class="samp">build_alias</span></samp>&rsquo;, &lsquo;<samp><span class="samp">build_cpu</span></samp>&rsquo;, &lsquo;<samp><span class="samp">build_vendor</span></samp>&rsquo;,
and &lsquo;<samp><span class="samp">build_os</span></samp>&rsquo;, which correspond to the similar &lsquo;<samp><span class="samp">target</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">host</span></samp>&rsquo; variables, except that they describe the build system.

   <p>When writing tests in <samp><span class="file">configure.in</span></samp>, you must remember that you
want to test the host environment, not the build environment.

   <p>Macros like &lsquo;<samp><span class="samp">AC_CHECK_FUNCS</span></samp>&rsquo; which use the compiler will test the
host environment.  That is because the tests will be done by running the
compiler, which is actually a build cross host compiler.  If the
compiler can find the function, that means that the function is present
in the host environment.

   <p>Tests like &lsquo;<samp><span class="samp">test -f /dev/ptyp0</span></samp>&rsquo;, on the other hand, will test the
build environment.  Remember that the configure script is running on the
build system, not the host system.  If your configure scripts examines
files, those files will be on the build system.  Whatever you determine
based on those files may or may not be the case on the host system.

   <p>Most autoconf macros will work correctly for a Canadian Cross.  The main
exception is &lsquo;<samp><span class="samp">AC_TRY_RUN</span></samp>&rsquo;.  This macro tries to compile and run a
test program.  This will fail in a Canadian Cross, because the program
will be compiled for the host system, which means that it will not run
on the build system.

   <p>The &lsquo;<samp><span class="samp">AC_TRY_RUN</span></samp>&rsquo; macro provides an optional argument to tell the
configure script what to do in a Canadian Cross.  If that argument is
not present, you will get a warning when you run &lsquo;<samp><span class="samp">autoconf</span></samp>&rsquo;:
<pre class="smallexample">     warning: AC_TRY_RUN called without default to allow cross compiling
</pre>
   <p class="noindent">This tells you that the resulting <samp><span class="file">configure</span></samp> script will not work
with a Canadian Cross.

   <p>In some cases while it may better to perform a test at configure time,
it is also possible to perform the test at run time.  In such a case you
can use the cross compiling argument to &lsquo;<samp><span class="samp">AC_TRY_RUN</span></samp>&rsquo; to tell your
program that the test could not be performed at configure time.

   <p>There are a few other autoconf macros which will not work correctly with
a Canadian Cross: a partial list is &lsquo;<samp><span class="samp">AC_FUNC_GETPGRP</span></samp>&rsquo;,
&lsquo;<samp><span class="samp">AC_FUNC_SETPGRP</span></samp>&rsquo;, &lsquo;<samp><span class="samp">AC_FUNC_SETVBUF_REVERSED</span></samp>&rsquo;, and
&lsquo;<samp><span class="samp">AC_SYS_RESTARTABLE_SYSCALLS</span></samp>&rsquo;.  The &lsquo;<samp><span class="samp">AC_CHECK_SIZEOF</span></samp>&rsquo; macro is
generally not very useful with a Canadian Cross; it permits an optional
argument indicating the default size, but there is no way to know what
the correct default should be.

<div class="node">
<a name="CCross-in-Make"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#CCross-in-Configure">CCross in Configure</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Supporting-Canadian-Cross">Supporting Canadian Cross</a>

</div>

<h4 class="subsection">6.7.2 Supporting Canadian Cross in Makefiles.</h4>

<p><a name="index-canadian-cross-in-makefile-65"></a>
The main Canadian Cross issue in a <samp><span class="file">Makefile</span></samp> arises when you want
to use a subsidiary program to generate code or data which you will then
include in your real program.

   <p>If you compile this subsidiary program using &lsquo;<samp><span class="samp">$(CC)</span></samp>&rsquo; in the usual
way, you will not be able to run it.  This is because &lsquo;<samp><span class="samp">$(CC)</span></samp>&rsquo; will
build a program for the host system, but the program is being built on
the build system.

   <p>You must instead use a compiler for the build system, rather than the
host system.  In the Cygnus tree, this make variable
&lsquo;<samp><span class="samp">$(CC_FOR_BUILD)</span></samp>&rsquo; will hold a compiler for the build system.

   <p>Note that you should not include <samp><span class="file">config.h</span></samp> in a file you are
compiling with &lsquo;<samp><span class="samp">$(CC_FOR_BUILD)</span></samp>&rsquo;.  The <samp><span class="file">configure</span></samp> script will
build <samp><span class="file">config.h</span></samp> with information for the host system.  However,
you are compiling the file using a compiler for the build system (a
native compiler).  Subsidiary programs are normally simple filters which
do no user interaction, and it is normally possible to write them in a
highly portable fashion so that the absence of <samp><span class="file">config.h</span></samp> is not
crucial.

   <p><a name="index-g_t_0040samp_007bHOST_005fCC_007d-66"></a>The gcc <samp><span class="file">Makefile.in</span></samp> shows a complex situation in which certain
files, such as <samp><span class="file">rtl.c</span></samp>, must be compiled into both subsidiary
programs run on the build system and into the final program.  This
approach may be of interest for advanced build system hackers.  Note
that the build system compiler is rather confusingly called
&lsquo;<samp><span class="samp">HOST_CC</span></samp>&rsquo;.

<div class="node">
<a name="Cygnus-Configure"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Multilibs">Multilibs</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Canadian-Cross">Canadian Cross</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">7 Cygnus Configure</h2>

<p><a name="index-cygnus-configure-67"></a>
The Cygnus configure script predates autoconf.  All of its interesting
features have been incorporated into autoconf.  No new programs should
be written to use the Cygnus configure script.

   <p>However, the Cygnus configure script is still used in a few places: at
the top of the Cygnus tree and in a few target libraries in the Cygnus
tree.  Until those uses have been replaced with autoconf, some brief
notes are appropriate here.  This is not complete documentation, but it
should be possible to use this as a guide while examining the scripts
themselves.

<ul class="menu">
<li><a accesskey="1" href="#Cygnus-Configure-Basics">Cygnus Configure Basics</a>: 		Cygnus Configure Basics. 
<li><a accesskey="2" href="#Cygnus-Configure-in-C_002b_002b-Libraries">Cygnus Configure in C++ Libraries</a>: 	Cygnus Configure in C++ Libraries. 
</ul>

<div class="node">
<a name="Cygnus-Configure-Basics"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Cygnus-Configure-in-C_002b_002b-Libraries">Cygnus Configure in C++ Libraries</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Cygnus-Configure">Cygnus Configure</a>

</div>

<h3 class="section">7.1 Cygnus Configure Basics</h3>

<p>Cygnus configure does not use any generated files; there is no program
corresponding to &lsquo;<samp><span class="samp">autoconf</span></samp>&rsquo;.  Instead, there is a single shell
script named &lsquo;<samp><span class="samp">configure</span></samp>&rsquo; which may be found at the top of the
Cygnus tree.  This shell script was written by hand; it was not
generated by autoconf, and it is incorrect, and indeed harmful, to run
&lsquo;<samp><span class="samp">autoconf</span></samp>&rsquo; in the top level of a Cygnus tree.

   <p>Cygnus configure works in a particular directory by examining the file
<samp><span class="file">configure.in</span></samp> in that directory.  That file is broken into four
separate shell scripts.

   <p>The first is the contents of <samp><span class="file">configure.in</span></samp> up to a line that
starts with &lsquo;<samp><span class="samp"># per-host:</span></samp>&rsquo;.  This is the common part.

   <p>The second is the rest of <samp><span class="file">configure.in</span></samp> up to a line that starts
with &lsquo;<samp><span class="samp"># per-target:</span></samp>&rsquo;.  This is the per host part.

   <p>The third is the rest of <samp><span class="file">configure.in</span></samp> up to a line that starts
with &lsquo;<samp><span class="samp"># post-target:</span></samp>&rsquo;.  This is the per target part.

   <p>The fourth is the remainder of <samp><span class="file">configure.in</span></samp>.  This is the post
target part.

   <p>If any of these comment lines are missing, the corresponding shell
script is empty.

   <p>Cygnus configure will first execute the common part.  This must set the
shell variable &lsquo;<samp><span class="samp">srctrigger</span></samp>&rsquo; to the name of a source file, to
confirm that Cygnus configure is looking at the right directory.  This
may set the shell variables &lsquo;<samp><span class="samp">package_makefile_frag</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">package_makefile_rules_frag</span></samp>&rsquo;.

   <p>Cygnus configure will next set the &lsquo;<samp><span class="samp">build</span></samp>&rsquo; and &lsquo;<samp><span class="samp">host</span></samp>&rsquo; shell
variables, and execute the per host part.  This may set the shell
variable &lsquo;<samp><span class="samp">host_makefile_frag</span></samp>&rsquo;.

   <p>Cygnus configure will next set the &lsquo;<samp><span class="samp">target</span></samp>&rsquo; variable, and execute
the per target part.  This may set the shell variable
&lsquo;<samp><span class="samp">target_makefile_frag</span></samp>&rsquo;.

   <p>Any of these scripts may set the &lsquo;<samp><span class="samp">subdirs</span></samp>&rsquo; shell variable.  This
variable is a list of subdirectories where a <samp><span class="file">Makefile.in</span></samp> file may
be found.  Cygnus configure will automatically look for a
<samp><span class="file">Makefile.in</span></samp> file in the current directory.  The &lsquo;<samp><span class="samp">subdirs</span></samp>&rsquo;
shell variable is not normally used, and I believe that the only
directory which uses it at present is <samp><span class="file">newlib</span></samp>.

   <p>For each <samp><span class="file">Makefile.in</span></samp>, Cygnus configure will automatically create
a <samp><span class="file">Makefile</span></samp> by adding definitions for &lsquo;<samp><span class="samp">make</span></samp>&rsquo; variables such
as &lsquo;<samp><span class="samp">host</span></samp>&rsquo; and &lsquo;<samp><span class="samp">target</span></samp>&rsquo;, and automatically editing the values
of &lsquo;<samp><span class="samp">make</span></samp>&rsquo; variables such as &lsquo;<samp><span class="samp">prefix</span></samp>&rsquo; if they are present.

   <p>Also, if any of the &lsquo;<samp><span class="samp">makefile_frag</span></samp>&rsquo; shell variables are set, Cygnus
configure will interpret them as file names relative to either the
working directory or the source directory, and will read the contents of
the file into the generated <samp><span class="file">Makefile</span></samp>.  The file contents will be
read in after the first line in <samp><span class="file">Makefile.in</span></samp> which starts with
&lsquo;<samp><span class="samp">####</span></samp>&rsquo;.

   <p>These <samp><span class="file">Makefile</span></samp> fragments are used to customize behaviour for a
particular host or target.  They serve to select particular files to
compile, and to define particular preprocessor macros by providing
values for &lsquo;<samp><span class="samp">make</span></samp>&rsquo; variables which are then used during compilation. 
Cygnus configure, unlike autoconf, normally does not do feature tests,
and normally requires support to be added manually for each new host.

   <p>The <samp><span class="file">Makefile</span></samp> fragment support is similar to the autoconf
&lsquo;<samp><span class="samp">AC_SUBST_FILE</span></samp>&rsquo; macro.

   <p>After creating each <samp><span class="file">Makefile</span></samp>, the post target script will be run
(i.e., it may be run several times).  This script may further customize
the <samp><span class="file">Makefile</span></samp>.  When it is run, the shell variable &lsquo;<samp><span class="samp">Makefile</span></samp>&rsquo;
will hold the name of the <samp><span class="file">Makefile</span></samp>, including the appropriate
directory component.

   <p>Like an autoconf generated <samp><span class="file">configure</span></samp> script, Cygnus configure
will create a file named <samp><span class="file">config.status</span></samp> which, when run, will
automatically recreate the configuration.  The <samp><span class="file">config.status</span></samp> file
will simply execute the Cygnus configure script again with the
appropriate arguments.

   <p>Any of the parts of <samp><span class="file">configure.in</span></samp> may set the shell variables
&lsquo;<samp><span class="samp">files</span></samp>&rsquo; and &lsquo;<samp><span class="samp">links</span></samp>&rsquo;.  Cygnus configure will set up symlinks
from the names in &lsquo;<samp><span class="samp">links</span></samp>&rsquo; to the files named in &lsquo;<samp><span class="samp">files</span></samp>&rsquo;.  This
is similar to the autoconf &lsquo;<samp><span class="samp">AC_LINK_FILES</span></samp>&rsquo; macro.

   <p>Finally, any of the parts of <samp><span class="file">configure.in</span></samp> may set the shell
variable &lsquo;<samp><span class="samp">configdirs</span></samp>&rsquo; to a set of subdirectories.  If it is set,
Cygnus configure will recursively run the configure process in each
subdirectory.  If the subdirectory uses Cygnus configure, it will
contain a <samp><span class="file">configure.in</span></samp> file but no <samp><span class="file">configure</span></samp> file, in
which case Cygnus configure will invoke itself recursively.  If the
subdirectory has a <samp><span class="file">configure</span></samp> file, Cygnus configure assumes that
it is an autoconf generated <samp><span class="file">configure</span></samp> script, and simply invokes
it directly.

<div class="node">
<a name="Cygnus-Configure-in-C++-Libraries"></a>
<a name="Cygnus-Configure-in-C_002b_002b-Libraries"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Cygnus-Configure-Basics">Cygnus Configure Basics</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Cygnus-Configure">Cygnus Configure</a>

</div>

<h3 class="section">7.2 Cygnus Configure in C++ Libraries</h3>

<p><a name="index-g_t_0040file_007blibstdc_002b_002b_007d-configure-68"></a><a name="index-g_t_0040file_007blibio_007d-configure-69"></a><a name="index-g_t_0040file_007blibg_002b_002b_007d-configure-70"></a>
The C++ library configure system, written by Per Bothner, deserves
special mention.  It uses Cygnus configure, but it does feature testing
like that done by autoconf generated <samp><span class="file">configure</span></samp> scripts.  This
approach is used in the libraries <samp><span class="file">libio</span></samp>, <samp><span class="file">libstdc++</span></samp>, and
<samp><span class="file">libg++</span></samp>.

   <p>Most of the <samp><span class="file">Makefile</span></samp> information is written out by the shell
script <samp><span class="file">libio/config.shared</span></samp>.  Each <samp><span class="file">configure.in</span></samp> file sets
certain shell variables, and then invokes <samp><span class="file">config.shared</span></samp> to create
two package <samp><span class="file">Makefile</span></samp> fragments.  These fragments are then
incorporated into the resulting <samp><span class="file">Makefile</span></samp> by the Cygnus configure
script.

   <p>The file <samp><span class="file">_G_config.h</span></samp> is created in the <samp><span class="file">libio</span></samp> object
directory by running the shell script <samp><span class="file">libio/gen-params</span></samp>.  This
shell script uses feature tests to define macros and typedefs in
<samp><span class="file">_G_config.h</span></samp>.

<div class="node">
<a name="Multilibs"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#FAQ">FAQ</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Cygnus-Configure">Cygnus Configure</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">8 Multilibs</h2>

<p><a name="index-multilibs-71"></a>
For some targets gcc may have different processor requirements depending
upon command line options.  An obvious example is the
&lsquo;<samp><span class="samp">-msoft-float</span></samp>&rsquo; option supported on several processors.  This option
means that the floating point registers are not available, which means
that floating point operations must be done by calling an emulation
subroutine rather than by using machine instructions.

   <p>For such options, gcc is often configured to compile target libraries
twice: once with &lsquo;<samp><span class="samp">-msoft-float</span></samp>&rsquo; and once without.  When gcc
compiles target libraries more than once, the resulting libraries are
called <dfn>multilibs</dfn>.

   <p>Multilibs are not really part of the GNU configure and build system, but
we discuss them here since they require support in the <samp><span class="file">configure</span></samp>
scripts and <samp><span class="file">Makefile</span></samp>s used for target libraries.

<ul class="menu">
<li><a accesskey="1" href="#Multilibs-in-gcc">Multilibs in gcc</a>: 		        Multilibs in gcc. 
<li><a accesskey="2" href="#Multilibs-in-Target-Libraries">Multilibs in Target Libraries</a>: 	Multilibs in Target Libraries. 
</ul>

<div class="node">
<a name="Multilibs-in-gcc"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Multilibs-in-Target-Libraries">Multilibs in Target Libraries</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Multilibs">Multilibs</a>

</div>

<h3 class="section">8.1 Multilibs in gcc</h3>

<p>In gcc, multilibs are defined by setting the variable
&lsquo;<samp><span class="samp">MULTILIB_OPTIONS</span></samp>&rsquo; in the target <samp><span class="file">Makefile</span></samp> fragment.  Several
other &lsquo;<samp><span class="samp">MULTILIB</span></samp>&rsquo; variables may also be defined there.  See <a href="gcc.html#Target-Fragment">The Target Makefile Fragment</a>.

   <p>If you have built gcc, you can see what multilibs it uses by running it
with the &lsquo;<samp><span class="samp">-print-multi-lib</span></samp>&rsquo; option.  The output &lsquo;<samp><span class="samp">.;</span></samp>&rsquo; means
that no multilibs are used.  In general, the output is a sequence of
lines, one per multilib.  The first part of each line, up to the
&lsquo;<samp><span class="samp">;</span></samp>&rsquo;, is the name of the multilib directory.  The second part is a
list of compiler options separated by &lsquo;<samp><span class="samp">@</span></samp>&rsquo; characters.

   <p>Multilibs are built in a tree of directories.  The top of the tree,
represented by &lsquo;<samp><span class="samp">.</span></samp>&rsquo; in the list of multilib directories, is the
default library to use when no special compiler options are used.  The
subdirectories of the tree hold versions of the library to use when
particular compiler options are used.

<div class="node">
<a name="Multilibs-in-Target-Libraries"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Multilibs-in-gcc">Multilibs in gcc</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Multilibs">Multilibs</a>

</div>

<h3 class="section">8.2 Multilibs in Target Libraries</h3>

<p>The target libraries in the Cygnus tree are automatically built with
multilibs.  That means that each library is built multiple times.

   <p>This default is set in the top level <samp><span class="file">configure.in</span></samp> file, by adding
&lsquo;<samp><span class="samp">--enable-multilib</span></samp>&rsquo; to the list of arguments passed to configure
when it is run for the target libraries (see <a href="#Host-and-Target-Libraries">Host and Target Libraries</a>).

   <p>Each target library uses the shell script <samp><span class="file">config-ml.in</span></samp>, written
by Doug Evans, to prepare to build target libraries.  This shell script
is invoked after the <samp><span class="file">Makefile</span></samp> has been created by the
<samp><span class="file">configure</span></samp> script.  If multilibs are not enabled, it does nothing,
otherwise it modifies the <samp><span class="file">Makefile</span></samp> to support multilibs.

   <p>The <samp><span class="file">config-ml.in</span></samp> script makes one copy of the <samp><span class="file">Makefile</span></samp> for
each multilib in the appropriate subdirectory.  When configuring in the
source directory (which is not recommended), it will build a symlink
tree of the sources in each subdirectory.

   <p>The <samp><span class="file">config-ml.in</span></samp> script sets several variables in the various
<samp><span class="file">Makefile</span></samp>s.  The <samp><span class="file">Makefile.in</span></samp> must have definitions for
these variables already; <samp><span class="file">config-ml.in</span></samp> simply changes the existing
values.  The <samp><span class="file">Makefile</span></samp> should use default values for these
variables which will do the right thing in the subdirectories.

     <dl>
<dt>&lsquo;<samp><span class="samp">MULTISRCTOP</span></samp>&rsquo;<dd><samp><span class="file">config-ml.in</span></samp> will set this to a sequence of &lsquo;<samp><span class="samp">../</span></samp>&rsquo; strings,
where the number of strings is the number of multilib levels in the
source tree.  The default value should be the empty string. 
<br><dt>&lsquo;<samp><span class="samp">MULTIBUILDTOP</span></samp>&rsquo;<dd><samp><span class="file">config-ml.in</span></samp> will set this to a sequence of &lsquo;<samp><span class="samp">../</span></samp>&rsquo; strings,
where the number of strings is number of multilib levels in the object
directory.  The default value should be the empty string.  This will
differ from &lsquo;<samp><span class="samp">MULTISRCTOP</span></samp>&rsquo; when configuring in the source tree
(which is not recommended). 
<br><dt>&lsquo;<samp><span class="samp">MULTIDIRS</span></samp>&rsquo;<dd>In the top level <samp><span class="file">Makefile</span></samp> only, <samp><span class="file">config-ml.in</span></samp> will set this
to the list of multilib subdirectories.  The default value should be the
empty string. 
<br><dt>&lsquo;<samp><span class="samp">MULTISUBDIR</span></samp>&rsquo;<dd><samp><span class="file">config-ml.in</span></samp> will set this to the installed subdirectory name to
use for this subdirectory, with a leading &lsquo;<samp><span class="samp">/</span></samp>&rsquo;.  The default value
shold be the empty string. 
<br><dt>&lsquo;<samp><span class="samp">MULTIDO</span></samp>&rsquo;<dt>&lsquo;<samp><span class="samp">MULTICLEAN</span></samp>&rsquo;<dd>In the top level <samp><span class="file">Makefile</span></samp> only, <samp><span class="file">config-ml.in</span></samp> will set
these variables to commands to use when doing a recursive make.  These
variables should both default to the string &lsquo;<samp><span class="samp">true</span></samp>&rsquo;, so that by
default nothing happens. 
</dl>

   <p>All references to the parent of the source directory should use the
variable &lsquo;<samp><span class="samp">MULTISRCTOP</span></samp>&rsquo;.  Instead of writing &lsquo;<samp><span class="samp">$(srcdir)/..</span></samp>&rsquo;,
you must write &lsquo;<samp><span class="samp">$(srcdir)/$(MULTISRCTOP)..</span></samp>&rsquo;.

   <p>Similarly, references to the parent of the object directory should use
the variable &lsquo;<samp><span class="samp">MULTIBUILDTOP</span></samp>&rsquo;.

   <p>In the installation target, the libraries should be installed in the
subdirectory &lsquo;<samp><span class="samp">MULTISUBDIR</span></samp>&rsquo;.  Instead of installing
&lsquo;<samp><span class="samp">$(libdir)/libfoo.a</span></samp>&rsquo;, install
&lsquo;<samp><span class="samp">$(libdir)$(MULTISUBDIR)/libfoo.a</span></samp>&rsquo;.

   <p>The <samp><span class="file">config-ml.in</span></samp> script also modifies the top level
<samp><span class="file">Makefile</span></samp> to add &lsquo;<samp><span class="samp">multi-do</span></samp>&rsquo; and &lsquo;<samp><span class="samp">multi-clean</span></samp>&rsquo; targets
which are used when building multilibs.

   <p>The default target of the <samp><span class="file">Makefile</span></samp> should include the following
command:
<pre class="smallexample">     @$(MULTIDO) $(FLAGS_TO_PASS) DO=all multi-do
</pre>
   <p class="noindent">This assumes that &lsquo;<samp><span class="samp">$(FLAGS_TO_PASS)</span></samp>&rsquo; is defined as a set of
variables to pass to a recursive invocation of &lsquo;<samp><span class="samp">make</span></samp>&rsquo;.  This will
build all the multilibs.  Note that the default value of &lsquo;<samp><span class="samp">MULTIDO</span></samp>&rsquo;
is &lsquo;<samp><span class="samp">true</span></samp>&rsquo;, so by default this command will do nothing.  It will
only do something in the top level <samp><span class="file">Makefile</span></samp> if multilibs were
enabled.

   <p>The &lsquo;<samp><span class="samp">install</span></samp>&rsquo; target of the <samp><span class="file">Makefile</span></samp> should include the
following command:
<pre class="smallexample">     @$(MULTIDO) $(FLAGS_TO_PASS) DO=install multi-do
</pre>
   <p>In general, any operation, other than clean, which should be performed
on all the multilibs should use a &lsquo;<samp><span class="samp">$(MULTIDO)</span></samp>&rsquo; line, setting the
variable &lsquo;<samp><span class="samp">DO</span></samp>&rsquo; to the target of each recursive call to &lsquo;<samp><span class="samp">make</span></samp>&rsquo;.

   <p>The &lsquo;<samp><span class="samp">clean</span></samp>&rsquo; targets (&lsquo;<samp><span class="samp">clean</span></samp>&rsquo;, &lsquo;<samp><span class="samp">mostlyclean</span></samp>&rsquo;, etc.) should
use &lsquo;<samp><span class="samp">$(MULTICLEAN)</span></samp>&rsquo;.  For example, the &lsquo;<samp><span class="samp">clean</span></samp>&rsquo; target should
do this:
<pre class="smallexample">     @$(MULTICLEAN) DO=clean multi-clean
</pre>
   <div class="node">
<a name="FAQ"></a>
<p><hr>
Next:&nbsp;<a rel="next" accesskey="n" href="#Index">Index</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="#Multilibs">Multilibs</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="chapter">9 Frequently Asked Questions</h2>

     <dl>
<dt>Which do I run first, &lsquo;<samp><span class="samp">autoconf</span></samp>&rsquo; or &lsquo;<samp><span class="samp">automake</span></samp>&rsquo;?<dd>Except when you first add autoconf or automake support to a package, you
shouldn't run either by hand.  Instead, configure with the
&lsquo;<samp><span class="samp">--enable-maintainer-mode</span></samp>&rsquo; option, and let &lsquo;<samp><span class="samp">make</span></samp>&rsquo; take care of
it.

     <p><a name="index-undefined-macros-72"></a><br><dt>&lsquo;<samp><span class="samp">autoconf</span></samp>&rsquo; says something about undefined macros.<dd>This means that you have macros in your <samp><span class="file">configure.in</span></samp> which are
not defined by &lsquo;<samp><span class="samp">autoconf</span></samp>&rsquo;.  You may be using an old version of
&lsquo;<samp><span class="samp">autoconf</span></samp>&rsquo;; try building and installing a newer one.  Make sure the
newly installled &lsquo;<samp><span class="samp">autoconf</span></samp>&rsquo; is first on your &lsquo;<samp><span class="samp">PATH</span></samp>&rsquo;.  Also,
see the next question.

     <p><a name="index-g_t_0040samp_007bCY_005fGNU_005fGETTEXT_007d-in-_0040file_007bconfigure_007d-73"></a><a name="index-g_t_0040samp_007bAM_005fPROG_005fLIBTOOL_007d-in-_0040file_007bconfigure_007d-74"></a><br><dt>My <samp><span class="file">configure</span></samp> script has stuff like &lsquo;<samp><span class="samp">CY_GNU_GETTEXT</span></samp>&rsquo; in it.<dd>This means that you have macros in your <samp><span class="file">configure.in</span></samp> which should
be defined in your <samp><span class="file">aclocal.m4</span></samp> file, but aren't.  This usually
means that &lsquo;<samp><span class="samp">aclocal</span></samp>&rsquo; was not able to appropriate definitions of the
macros.  Make sure that you have installed all the packages you need. 
In particular, make sure that you have installed libtool (this is where
&lsquo;<samp><span class="samp">AM_PROG_LIBTOOL</span></samp>&rsquo; is defined) and gettext (this is where
&lsquo;<samp><span class="samp">CY_GNU_GETTEXT</span></samp>&rsquo; is defined, at least in the Cygnus version of
gettext).

     <p><a name="index-g_t_0040file_007bMakefile_007d_002c-garbage-characters-75"></a><br><dt>My <samp><span class="file">Makefile</span></samp> has &lsquo;<samp><span class="samp">@</span></samp>&rsquo; characters in it.<dd>This may mean that you tried to use an autoconf substitution in your
<samp><span class="file">Makefile.in</span></samp> without adding the appropriate &lsquo;<samp><span class="samp">AC_SUBST</span></samp>&rsquo; call
to your <samp><span class="file">configure</span></samp> script.  Or it may just mean that you need to
rebuild <samp><span class="file">Makefile</span></samp> in your build directory.  To rebuild
<samp><span class="file">Makefile</span></samp> from <samp><span class="file">Makefile.in</span></samp>, run the shell script
<samp><span class="file">config.status</span></samp> with no arguments.  If you need to force
<samp><span class="file">configure</span></samp> to run again, first run &lsquo;<samp><span class="samp">config.status --recheck</span></samp>&rsquo;. 
These runs are normally done automatically by <samp><span class="file">Makefile</span></samp> targets,
but if your <samp><span class="file">Makefile</span></samp> has gotten messed up you'll need to help
them along.

     <p><a name="index-g_t_0040samp_007bconfig_002estatus-_002d_002drecheck_007d-76"></a><br><dt>Why do I have to run both &lsquo;<samp><span class="samp">config.status --recheck</span></samp>&rsquo; and &lsquo;<samp><span class="samp">config.status</span></samp>&rsquo;?<dd>Normally, you don't; they will be run automatically by <samp><span class="file">Makefile</span></samp>
targets.  If you do need to run them, use &lsquo;<samp><span class="samp">config.status --recheck</span></samp>&rsquo;
to run the <samp><span class="file">configure</span></samp> script again with the same arguments as the
first time you ran it.  Use &lsquo;<samp><span class="samp">config.status</span></samp>&rsquo; (with no arguments) to
regenerate all files (<samp><span class="file">Makefile</span></samp>, <samp><span class="file">config.h</span></samp>, etc.) based on
the results of the configure script.  The two cases are separate because
it isn't always necessary to regenerate all the files after running
&lsquo;<samp><span class="samp">config.status --recheck</span></samp>&rsquo;.  The <samp><span class="file">Makefile</span></samp> targets generated
by automake will use the environment variables &lsquo;<samp><span class="samp">CONFIG_FILES</span></samp>&rsquo; and
&lsquo;<samp><span class="samp">CONFIG_HEADERS</span></samp>&rsquo; to only regenerate files as they are needed.

     <br><dt>What is the Cygnus tree?<dd>The Cygnus tree is used for various packages including gdb, the GNU
binutils, and egcs.  It is also, of course, used for Cygnus releases. 
It is the build system which was developed at Cygnus, using the Cygnus
configure script.  It permits building many different packages with a
single configure and make.  The configure scripts in the tree are being
converted to autoconf, but the general build structure remains intact.

     <br><dt>Why do I have to keep rebuilding and reinstalling the tools?<dd>I know, it's a pain.  Unfortunately, there are bugs in the tools
themselves which need to be fixed, and each time that happens everybody
who uses the tools need to reinstall new versions of them.  I don't know
if there is going to be a clever fix until the tools stabilize.

     <br><dt>Why not just have a Cygnus tree &lsquo;<samp><span class="samp">make</span></samp>&rsquo; target to update the tools?<dd>The tools unfortunately need to be installed before they can be used. 
That means that they must be built using an appropriate prefix, and it
seems unwise to assume that every configuration uses an appropriate
prefix.  It might be possible to make them work in place, or it might be
possible to install them in some subdirectory; so far these approaches
have not been implemented. 
</dl>

<div class="node">
<a name="Index"></a>
<p><hr>
Previous:&nbsp;<a rel="previous" accesskey="p" href="#FAQ">FAQ</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="#Top">Top</a>

</div>

<h2 class="unnumbered">Index</h2>

<ul class="index-cp" compact>
<li><a href="#index-g_t_0040samp_007b_002d_002dbuild_007d-option-57">&lsquo;<samp><span class="samp">--build</span></samp>&rsquo; option</a>: <a href="#Build-and-Host-Options">Build and Host Options</a></li>
<li><a href="#index-g_t_0040samp_007b_002d_002dhost_007d-option-60">&lsquo;<samp><span class="samp">--host</span></samp>&rsquo; option</a>: <a href="#Build-and-Host-Options">Build and Host Options</a></li>
<li><a href="#index-g_t_0040samp_007b_002d_002dtarget_007d-option-48">&lsquo;<samp><span class="samp">--target</span></samp>&rsquo; option</a>: <a href="#Specifying-the-Target">Specifying the Target</a></li>
<li><a href="#index-g_t_0040samp_007b_005fGNU_005fSOURCE_007d-16">&lsquo;<samp><span class="samp">_GNU_SOURCE</span></samp>&rsquo;</a>: <a href="#Write-configure_002ein">Write configure.in</a></li>
<li><a href="#index-g_t_0040samp_007bAC_005fCANONICAL_005fHOST_007d-47">&lsquo;<samp><span class="samp">AC_CANONICAL_HOST</span></samp>&rsquo;</a>: <a href="#Using-the-Host-Type">Using the Host Type</a></li>
<li><a href="#index-g_t_0040samp_007bAC_005fCANONICAL_005fSYSTEM_007d-51">&lsquo;<samp><span class="samp">AC_CANONICAL_SYSTEM</span></samp>&rsquo;</a>: <a href="#Using-the-Target-Type">Using the Target Type</a></li>
<li><a href="#index-g_t_0040samp_007bAC_005fCONFIG_005fHEADER_007d-8">&lsquo;<samp><span class="samp">AC_CONFIG_HEADER</span></samp>&rsquo;</a>: <a href="#Write-configure_002ein">Write configure.in</a></li>
<li><a href="#index-g_t_0040samp_007bAC_005fEXEEXT_007d-10">&lsquo;<samp><span class="samp">AC_EXEEXT</span></samp>&rsquo;</a>: <a href="#Write-configure_002ein">Write configure.in</a></li>
<li><a href="#index-g_t_0040samp_007bAC_005fINIT_007d-4">&lsquo;<samp><span class="samp">AC_INIT</span></samp>&rsquo;</a>: <a href="#Write-configure_002ein">Write configure.in</a></li>
<li><a href="#index-g_t_0040samp_007bAC_005fOUTPUT_007d-17">&lsquo;<samp><span class="samp">AC_OUTPUT</span></samp>&rsquo;</a>: <a href="#Write-configure_002ein">Write configure.in</a></li>
<li><a href="#index-g_t_0040samp_007bAC_005fPREREQ_007d-5">&lsquo;<samp><span class="samp">AC_PREREQ</span></samp>&rsquo;</a>: <a href="#Write-configure_002ein">Write configure.in</a></li>
<li><a href="#index-g_t_0040samp_007bAC_005fPROG_005fCC_007d-12">&lsquo;<samp><span class="samp">AC_PROG_CC</span></samp>&rsquo;</a>: <a href="#Write-configure_002ein">Write configure.in</a></li>
<li><a href="#index-g_t_0040samp_007bAC_005fPROG_005fCXX_007d-13">&lsquo;<samp><span class="samp">AC_PROG_CXX</span></samp>&rsquo;</a>: <a href="#Write-configure_002ein">Write configure.in</a></li>
<li><a href="#index-g_t_0040file_007bacconfig_002eh_007d-22"><samp><span class="file">acconfig.h</span></samp></a>: <a href="#Written-Developer-Files">Written Developer Files</a></li>
<li><a href="#index-g_t_0040file_007bacconfig_002eh_007d_002c-writing-19"><samp><span class="file">acconfig.h</span></samp>, writing</a>: <a href="#Write-acconfig_002eh">Write acconfig.h</a></li>
<li><a href="#index-g_t_0040file_007bacinclude_002em4_007d-23"><samp><span class="file">acinclude.m4</span></samp></a>: <a href="#Written-Developer-Files">Written Developer Files</a></li>
<li><a href="#index-g_t_0040file_007baclocal_002em4_007d-26"><samp><span class="file">aclocal.m4</span></samp></a>: <a href="#Generated-Developer-Files">Generated Developer Files</a></li>
<li><a href="#index-g_t_0040samp_007bAM_005fCONFIG_005fHEADER_007d-7">&lsquo;<samp><span class="samp">AM_CONFIG_HEADER</span></samp>&rsquo;</a>: <a href="#Write-configure_002ein">Write configure.in</a></li>
<li><a href="#index-g_t_0040samp_007bAM_005fDISABLE_005fSHARED_007d-15">&lsquo;<samp><span class="samp">AM_DISABLE_SHARED</span></samp>&rsquo;</a>: <a href="#Write-configure_002ein">Write configure.in</a></li>
<li><a href="#index-g_t_0040samp_007bAM_005fEXEEXT_007d-11">&lsquo;<samp><span class="samp">AM_EXEEXT</span></samp>&rsquo;</a>: <a href="#Write-configure_002ein">Write configure.in</a></li>
<li><a href="#index-g_t_0040samp_007bAM_005fINIT_005fAUTOMAKE_007d-6">&lsquo;<samp><span class="samp">AM_INIT_AUTOMAKE</span></samp>&rsquo;</a>: <a href="#Write-configure_002ein">Write configure.in</a></li>
<li><a href="#index-g_t_0040samp_007bAM_005fMAINTAINER_005fMODE_007d-9">&lsquo;<samp><span class="samp">AM_MAINTAINER_MODE</span></samp>&rsquo;</a>: <a href="#Write-configure_002ein">Write configure.in</a></li>
<li><a href="#index-g_t_0040samp_007bAM_005fPROG_005fLIBTOOL_007d-14">&lsquo;<samp><span class="samp">AM_PROG_LIBTOOL</span></samp>&rsquo;</a>: <a href="#Write-configure_002ein">Write configure.in</a></li>
<li><a href="#index-g_t_0040samp_007bAM_005fPROG_005fLIBTOOL_007d-in-_0040file_007bconfigure_007d-74">&lsquo;<samp><span class="samp">AM_PROG_LIBTOOL</span></samp>&rsquo; in <samp><span class="file">configure</span></samp></a>: <a href="#FAQ">FAQ</a></li>
<li><a href="#index-build-option-58">build option</a>: <a href="#Build-and-Host-Options">Build and Host Options</a></li>
<li><a href="#index-building-with-a-cross-compiler-53">building with a cross compiler</a>: <a href="#Canadian-Cross">Canadian Cross</a></li>
<li><a href="#index-canadian-cross-52">canadian cross</a>: <a href="#Canadian-Cross">Canadian Cross</a></li>
<li><a href="#index-canadian-cross-in-configure-64">canadian cross in configure</a>: <a href="#CCross-in-Configure">CCross in Configure</a></li>
<li><a href="#index-canadian-cross-in-cygnus-tree-63">canadian cross in cygnus tree</a>: <a href="#CCross-in-Cygnus-Tree">CCross in Cygnus Tree</a></li>
<li><a href="#index-canadian-cross-in-makefile-65">canadian cross in makefile</a>: <a href="#CCross-in-Make">CCross in Make</a></li>
<li><a href="#index-canadian-cross_002c-configuring-56">canadian cross, configuring</a>: <a href="#Build-and-Host-Options">Build and Host Options</a></li>
<li><a href="#index-canonical-system-names-40">canonical system names</a>: <a href="#Configuration-Names">Configuration Names</a></li>
<li><a href="#index-g_t_0040file_007bconfig_002ecache_007d-33"><samp><span class="file">config.cache</span></samp></a>: <a href="#Build-Files-Description">Build Files Description</a></li>
<li><a href="#index-g_t_0040file_007bconfig_002eh_007d-32"><samp><span class="file">config.h</span></samp></a>: <a href="#Build-Files-Description">Build Files Description</a></li>
<li><a href="#index-g_t_0040file_007bconfig_002eh_002ein_007d-28"><samp><span class="file">config.h.in</span></samp></a>: <a href="#Generated-Developer-Files">Generated Developer Files</a></li>
<li><a href="#index-g_t_0040file_007bconfig_002ein_007d-27"><samp><span class="file">config.in</span></samp></a>: <a href="#Generated-Developer-Files">Generated Developer Files</a></li>
<li><a href="#index-g_t_0040file_007bconfig_002estatus_007d-30"><samp><span class="file">config.status</span></samp></a>: <a href="#Build-Files-Description">Build Files Description</a></li>
<li><a href="#index-g_t_0040samp_007bconfig_002estatus-_002d_002drecheck_007d-76">&lsquo;<samp><span class="samp">config.status --recheck</span></samp>&rsquo;</a>: <a href="#FAQ">FAQ</a></li>
<li><a href="#index-configuration-names-35">configuration names</a>: <a href="#Configuration-Names">Configuration Names</a></li>
<li><a href="#index-configuration-triplets-36">configuration triplets</a>: <a href="#Configuration-Names">Configuration Names</a></li>
<li><a href="#index-g_t_0040file_007bconfigure_007d-24"><samp><span class="file">configure</span></samp></a>: <a href="#Generated-Developer-Files">Generated Developer Files</a></li>
<li><a href="#index-configure-build-system-59">configure build system</a>: <a href="#Build-and-Host-Options">Build and Host Options</a></li>
<li><a href="#index-configure-host-62">configure host</a>: <a href="#Build-and-Host-Options">Build and Host Options</a></li>
<li><a href="#index-configure-target-50">configure target</a>: <a href="#Specifying-the-Target">Specifying the Target</a></li>
<li><a href="#index-g_t_0040file_007bconfigure_002ein_007d-20"><samp><span class="file">configure.in</span></samp></a>: <a href="#Written-Developer-Files">Written Developer Files</a></li>
<li><a href="#index-g_t_0040file_007bconfigure_002ein_007d_002c-writing-3"><samp><span class="file">configure.in</span></samp>, writing</a>: <a href="#Write-configure_002ein">Write configure.in</a></li>
<li><a href="#index-configuring-a-canadian-cross-55">configuring a canadian cross</a>: <a href="#Build-and-Host-Options">Build and Host Options</a></li>
<li><a href="#index-cross-compiler-44">cross compiler</a>: <a href="#Cross-Compilation-Concepts">Cross Compilation Concepts</a></li>
<li><a href="#index-cross-compiler_002c-building-with-54">cross compiler, building with</a>: <a href="#Canadian-Cross">Canadian Cross</a></li>
<li><a href="#index-cross-tools-43">cross tools</a>: <a href="#Cross-Compilation-Tools">Cross Compilation Tools</a></li>
<li><a href="#index-g_t_0040samp_007bCY_005fGNU_005fGETTEXT_007d-in-_0040file_007bconfigure_007d-73">&lsquo;<samp><span class="samp">CY_GNU_GETTEXT</span></samp>&rsquo; in <samp><span class="file">configure</span></samp></a>: <a href="#FAQ">FAQ</a></li>
<li><a href="#index-cygnus-configure-67">cygnus configure</a>: <a href="#Cygnus-Configure">Cygnus Configure</a></li>
<li><a href="#index-goals-1">goals</a>: <a href="#Goals">Goals</a></li>
<li><a href="#index-history-2">history</a>: <a href="#History">History</a></li>
<li><a href="#index-host-names-38">host names</a>: <a href="#Configuration-Names">Configuration Names</a></li>
<li><a href="#index-host-option-61">host option</a>: <a href="#Build-and-Host-Options">Build and Host Options</a></li>
<li><a href="#index-host-system-45">host system</a>: <a href="#Host-and-Target">Host and Target</a></li>
<li><a href="#index-host-triplets-39">host triplets</a>: <a href="#Configuration-Names">Configuration Names</a></li>
<li><a href="#index-g_t_0040samp_007bHOST_005fCC_007d-66">&lsquo;<samp><span class="samp">HOST_CC</span></samp>&rsquo;</a>: <a href="#CCross-in-Make">CCross in Make</a></li>
<li><a href="#index-g_t_0040file_007blibg_002b_002b_007d-configure-70"><samp><span class="file">libg++</span></samp> configure</a>: <a href="#Cygnus-Configure-in-C_002b_002b-Libraries">Cygnus Configure in C++ Libraries</a></li>
<li><a href="#index-g_t_0040file_007blibio_007d-configure-69"><samp><span class="file">libio</span></samp> configure</a>: <a href="#Cygnus-Configure-in-C_002b_002b-Libraries">Cygnus Configure in C++ Libraries</a></li>
<li><a href="#index-g_t_0040file_007blibstdc_002b_002b_007d-configure-68"><samp><span class="file">libstdc++</span></samp> configure</a>: <a href="#Cygnus-Configure-in-C_002b_002b-Libraries">Cygnus Configure in C++ Libraries</a></li>
<li><a href="#index-g_t_0040file_007bMakefile_007d-31"><samp><span class="file">Makefile</span></samp></a>: <a href="#Build-Files-Description">Build Files Description</a></li>
<li><a href="#index-g_t_0040file_007bMakefile_007d_002c-garbage-characters-75"><samp><span class="file">Makefile</span></samp>, garbage characters</a>: <a href="#FAQ">FAQ</a></li>
<li><a href="#index-g_t_0040file_007bMakefile_002eam_007d-21"><samp><span class="file">Makefile.am</span></samp></a>: <a href="#Written-Developer-Files">Written Developer Files</a></li>
<li><a href="#index-g_t_0040file_007bMakefile_002eam_007d_002c-writing-18"><samp><span class="file">Makefile.am</span></samp>, writing</a>: <a href="#Write-Makefile_002eam">Write Makefile.am</a></li>
<li><a href="#index-g_t_0040file_007bMakefile_002ein_007d-25"><samp><span class="file">Makefile.in</span></samp></a>: <a href="#Generated-Developer-Files">Generated Developer Files</a></li>
<li><a href="#index-multilibs-71">multilibs</a>: <a href="#Multilibs">Multilibs</a></li>
<li><a href="#index-g_t_0040file_007bstamp_002dh_007d-34"><samp><span class="file">stamp-h</span></samp></a>: <a href="#Build-Files-Description">Build Files Description</a></li>
<li><a href="#index-g_t_0040file_007bstamp_002dh_002ein_007d-29"><samp><span class="file">stamp-h.in</span></samp></a>: <a href="#Generated-Developer-Files">Generated Developer Files</a></li>
<li><a href="#index-system-names-41">system names</a>: <a href="#Configuration-Names">Configuration Names</a></li>
<li><a href="#index-system-types-42">system types</a>: <a href="#Configuration-Names">Configuration Names</a></li>
<li><a href="#index-target-option-49">target option</a>: <a href="#Specifying-the-Target">Specifying the Target</a></li>
<li><a href="#index-target-system-46">target system</a>: <a href="#Host-and-Target">Host and Target</a></li>
<li><a href="#index-triplets-37">triplets</a>: <a href="#Configuration-Names">Configuration Names</a></li>
<li><a href="#index-undefined-macros-72">undefined macros</a>: <a href="#FAQ">FAQ</a></li>
</ul>
<div class="contents">
<h2>Table of Contents</h2>
<ul>
<li><a name="toc_Top" href="#Top">GNU configure and build system</a>
<li><a name="toc_Introduction" href="#Introduction">1 Introduction</a>
<ul>
<li><a href="#Goals">1.1 Goals</a>
<li><a href="#Tools">1.2 Tools</a>
<li><a href="#History">1.3 History</a>
<li><a href="#Building">1.4 Building</a>
</li></ul>
<li><a name="toc_Getting-Started" href="#Getting-Started">2 Getting Started</a>
<ul>
<li><a href="#Write-configure_002ein">2.1 Write configure.in</a>
<li><a href="#Write-Makefile_002eam">2.2 Write Makefile.am</a>
<li><a href="#Write-acconfig_002eh">2.3 Write acconfig.h</a>
<li><a href="#Generate-files">2.4 Generate files</a>
<li><a href="#Getting-Started-Example">2.5 Example</a>
<ul>
<li><a href="#Getting-Started-Example-1">2.5.1 First Try</a>
<li><a href="#Getting-Started-Example-2">2.5.2 Second Try</a>
<li><a href="#Getting-Started-Example-3">2.5.3 Third Try</a>
<li><a href="#Generate-Files-in-Example">2.5.4 Generate Files</a>
</li></ul>
</li></ul>
<li><a name="toc_Files" href="#Files">3 Files</a>
<ul>
<li><a href="#Developer-Files">3.1 Developer Files</a>
<ul>
<li><a href="#Developer-Files-Picture">3.1.1 Developer Files Picture</a>
<li><a href="#Written-Developer-Files">3.1.2 Written Developer Files</a>
<li><a href="#Generated-Developer-Files">3.1.3 Generated Developer Files</a>
</li></ul>
<li><a href="#Build-Files">3.2 Build Files</a>
<ul>
<li><a href="#Build-Files-Picture">3.2.1 Build Files Picture</a>
<li><a href="#Build-Files-Description">3.2.2 Build Files Description</a>
</li></ul>
<li><a href="#Support-Files">3.3 Support Files</a>
</li></ul>
<li><a name="toc_Configuration-Names" href="#Configuration-Names">4 Configuration Names</a>
<ul>
<li><a href="#Configuration-Name-Definition">4.1 Configuration Name Definition</a>
<li><a href="#Using-Configuration-Names">4.2 Using Configuration Names</a>
</li></ul>
<li><a name="toc_Cross-Compilation-Tools" href="#Cross-Compilation-Tools">5 Cross Compilation Tools</a>
<ul>
<li><a href="#Cross-Compilation-Concepts">5.1 Cross Compilation Concepts</a>
<li><a href="#Host-and-Target">5.2 Host and Target</a>
<li><a href="#Using-the-Host-Type">5.3 Using the Host Type</a>
<li><a href="#Specifying-the-Target">5.4 Specifying the Target</a>
<li><a href="#Using-the-Target-Type">5.5 Using the Target Type</a>
<li><a href="#Cross-Tools-in-the-Cygnus-Tree">5.6 Cross Tools in the Cygnus Tree</a>
<ul>
<li><a href="#Host-and-Target-Libraries">5.6.1 Host and Target Libraries</a>
<li><a href="#Target-Library-Configure-Scripts">5.6.2 Target Library Configure Scripts</a>
<li><a href="#Make-Targets-in-Cygnus-Tree">5.6.3 Make Targets in Cygnus Tree</a>
<li><a href="#Target-libiberty">5.6.4 Target libiberty</a>
</li></ul>
</li></ul>
<li><a name="toc_Canadian-Cross" href="#Canadian-Cross">6 Canadian Cross</a>
<ul>
<li><a href="#Canadian-Cross-Example">6.1 Canadian Cross Example</a>
<li><a href="#Canadian-Cross-Concepts">6.2 Canadian Cross Concepts</a>
<li><a href="#Build-Cross-Host-Tools">6.3 Build Cross Host Tools</a>
<li><a href="#Build-and-Host-Options">6.4 Build and Host Options</a>
<li><a href="#CCross-not-in-Cygnus-Tree">6.5 Canadian Cross not in Cygnus Tree.</a>
<li><a href="#CCross-in-Cygnus-Tree">6.6 Canadian Cross in Cygnus Tree</a>
<ul>
<li><a href="#Standard-Cygnus-CCross">6.6.1 Building a Normal Program</a>
<li><a href="#Cross-Cygnus-CCross">6.6.2 Building a Cross Program</a>
</li></ul>
<li><a href="#Supporting-Canadian-Cross">6.7 Supporting Canadian Cross</a>
<ul>
<li><a href="#CCross-in-Configure">6.7.1 Supporting Canadian Cross in Configure Scripts</a>
<li><a href="#CCross-in-Make">6.7.2 Supporting Canadian Cross in Makefiles.</a>
</li></ul>
</li></ul>
<li><a name="toc_Cygnus-Configure" href="#Cygnus-Configure">7 Cygnus Configure</a>
<ul>
<li><a href="#Cygnus-Configure-Basics">7.1 Cygnus Configure Basics</a>
<li><a href="#Cygnus-Configure-in-C_002b_002b-Libraries">7.2 Cygnus Configure in C++ Libraries</a>
</li></ul>
<li><a name="toc_Multilibs" href="#Multilibs">8 Multilibs</a>
<ul>
<li><a href="#Multilibs-in-gcc">8.1 Multilibs in gcc</a>
<li><a href="#Multilibs-in-Target-Libraries">8.2 Multilibs in Target Libraries</a>
</li></ul>
<li><a name="toc_FAQ" href="#FAQ">9 Frequently Asked Questions</a>
<li><a name="toc_Index" href="#Index">Index</a>
</li></ul>
</div>

</body></html>

